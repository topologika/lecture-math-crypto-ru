Алгоритм повторного возведения в квадрат служит для вычисления числа $m^e\pmod n$. Идею алгоритма рассмотрим на примере вычисления числа $5^{16}\pmod{23}$. По определению

\[5^{16}\pmod{23}=5\cdot 5\cdot 5\cdot 5\cdot 5\cdot 5\cdot 5\cdot 5\cdot 5\cdot 5\cdot 5\cdot 5\cdot 5\cdot 5\cdot 5\cdot 5\pmod{23}\] 

Вычисление можно проводить последовательно, умножая промежуточный результат на число $5$ по модулю $23$ $15$ раз. Вычислим $5^2\pmod{23}=2$. Заметим, что теперь

\[5^{16}=2\cdot 2\cdot 2\cdot 2\cdot 2\cdot 2\cdot 2\cdot 2\pmod{23}\] 

Вычислим $2^2\pmod{23}=4$. Теперь

\[5^{16}=4\cdot 4\cdot 4\cdot 4\pmod{23}\] 

Вычислим $4^2\pmod{23}=16$. Теперь

\[5^{16}=16\cdot 16\pmod{23}\] 

Найдем ${16}^2\pmod{23}=3$. Таким образом, для вычисления $5^{16}=3\pmod{23}$ было сделано $4$ умножений по модулю $23$, а не $16$, как это было бы, если бы возведение в степень проводилось по определению.

Алгоритм, аналогичный повторному возведению в квадрат, можно с таким же успехом для экономии вычислительных средств осуществлять как повторное возведение в куб и т.д. и т.п.

Алгоритм повторного возведения в квадрат для вычисления $m^e\pmod n$ приведен ниже в более формальном виде.

\begin{enumerate}
\item  Представим $e$ в двоичной системе счисления $e=e_02^r+\ldots +e_{r-1}2+e_r$, где $e_i$, цифры в двоичном представлении, равны 0 или 1, $e_0=1$.

\item  Положим $m_0=m$ и затем для $i=1,\ldots ,r$ вычислим $m_i=m^2_{i-1}\cdot m^{e_i}\pmod n$

\item  $m_r$ есть искомое $m^e\pmod n$. 
\end{enumerate}

Так как каждое вычисление на шаге 2 требует не более трех умножений по модулю $n$ и этот шаг выполняется $r\le \log_2n$ раз, то сложность алгоритма может быть оценена величиной $O(\ln n)$.


\subsection*{Упражнения}

Запишите алгоритм на алгоритмическом языке, который вы знаете.

