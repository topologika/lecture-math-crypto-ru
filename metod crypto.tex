\documentclass[12pt,a4paper]{report}
%\usepackage{amsthm}
%\usepackage{amssymb}
\usepackage[cp1251]{inputenc}
\usepackage[T2A]{fontenc}
\usepackage[russian]{babel}

\usepackage{geometry} % Меняем поля страницы
\geometry{left=2cm}% левое поле
\geometry{right=1.5cm}% правое поле
\geometry{top=1cm}% верхнее поле
\geometry{bottom=2cm}% нижнее поле

\newtheorem{theorem}{Теорема}[section]
\newtheorem{lemma}{Лемма}[section]
\newtheorem{corollary}{Следствие}[section]
\newtheorem{definition}{Определение}[section]
\righthyphenmin=2
\sloppy

 \linespread{1.0}

\begin{document}
\Large

\begin{titlepage}

\newpage

\begin{center}
{\small МИНИСТЕРСТВО OБРАЗОВАНИЯ И НАУКИ,\\
МОЛОДЕЖИ И СПОРТА УКРАИНЫ\\}
\vspace{0.5cm}
ДОНЕЦКИЙ НАЦИОНАЛЬНЫЙ УНИВЕРСИТЕТ\\*
Физический факультет\\*
Кафедра компьютерных технологий\\*
\hrulefill
\end{center}

%\flushright{КАФЕДРА \No ХХХ}

\vspace{8em}

\begin{center}
\Large Курс лекций
\end{center}

\vspace{2.5em}

\begin{center}
\textsc{\textbf{Специальные функции}}
\end{center}


\vspace{\fill}

\begin{center}
Донецк, ДонНУ, 2013
\end{center}
\newpage

\begin{flushleft}
ББК 32.973\\
УДК 681.518
\end{flushleft}

А.Н.~Курганский \textbf{Курс лекций "`Специальные функции"'}.~-- Донецк: ДонНУ, 2013. - 60 с.

\vspace{1em}

В курсе лекций изложены
\vspace{1em}

\noindent
\textbf{Автор:} А.Н.~Курганский, к.ф.-м.н.,  и.о.доцента  кафедры  Компьютерных  технологий 
физического факультета ДонНУ.
\vspace{1em}

\noindent
\textbf{Рецензенты:}
\vspace{1em}

\noindent
д.ф.-м.н., профессор, не знаю кто

\vspace{1em}

\noindent
д.т.н., профессор,  зав.  кафедрой компьютерных  технологий физического факультета 
ДонНУ Каргин А.А.
\vspace{1em}

\noindent
\textbf{Ответственный за выпуск:} д.т.н.,  доцент  кафедры  компьютерных  технологий 
физического факультета ДонНУ Толстых В.К. 

%\begin{flushleft}
%Студент--дипломник \hrulefill Пупкин А.А. \\
%\vspace{1.5em}
%Научный руководитель \\
%доцент \hrulefill Иванов Б.Б.\\
%\vspace{1.5em}
%Рецензент \\
%к.ф.-м.н., в.н.с. АБВГ \hrulefill Петров В.В.\\
%\vspace{1.5em}
%Зав. кафедрой \No ХХХ \\
%д.ф-м.н, профессор \hrulefill Сидоров Г.Г.
%\end{flushleft}



\end{titlepage}

\tableofcontents
\newpage

\section*{Задачи криптографии}

Курс лекций посвящен математическим основам криптографии. Криптография~-- наука о математических методах защиты информации, а именно обеспечения конфиденциальности, аутентификации (подлинности, то есть отсутствие случайных или преднамеренных искажений, источника и содержимого передаваемой информации), целостности (подлинность источника и содержимого как хранимой, так и передаваемой информации), невозможности отказа, неотслеживаемости информации, доказательства знаний, фиксации (привязка к информации) при наличии угроз как со стороны посторонних лиц (противника, мошенника, злоумышленника), так и со стороны нарушителей среди участников обмена информацией.

Задачи криптографической защиты информации решаются с помощью криптографических протоколов. Криптографические протоколы представляют собой распределенные алгоритмы, обеспечивающие решение криптографической задачи несколькими участниками обмена информацией, когда они не доверяют другу друг. Криптографические протоколы обеспечивают выполнения правил «игры» всеми участниками обмена информацией, в том числе недобросовестными и посторонними лицами.

Криптографический мир разделён на два противодействующих друг другу мира: криптографию и криптоанализ. Криптографы обеспечивают безопасность информации, криптоаналитики находят уязвимости в методах криптографов. Криптография и криптоанализ вместе образуют криптологию. Криптография чрезвычайно востребована на практике и, поскольку на стороне криптографии и криптоанализа играют умные энергичные люди и временный успех достигается поочередно то теми, то другими, сложность криптографической науки постоянно растет. Криптология является самоусложняющейся наукой.

Алгоритмы защиты информации требуют обоснованного убеждения пользователей в их правильности. Существуют разные способы убеждения. Объективным способом убеждения является математическое доказательство. Поэтому криптография и криптоанализ являются сложными именно математическими науками. Наряду с функцией доказательства математика, обладая очень точной грамматикой, играет роль языка общения. Как инструмент доказательства математика позволяет понимать, почему криптографические алгоритмы делают то, что должны делать. Как язык общения она необходима, хотя и не достаточна, для понимания шагов и действий современных криптографических алгоритмов. Изучению необходимого для введения в криптографию минимума этого «иностранного» языка абстрактной алгебры и теории чисел посвящен данный курс.

%Изучение будет проходить следующим образом. Будут приведены некоторые современные криптографические алгоритмы в качестве учебных примеров и разобраны встречающиеся в них математические слова и функции.

От студента требуется знакомство с математикой в несколько большем объеме, чем предусмотрено в средней школе. Например, студенту необходимо быть знакомым с основами линейной алгебры, математического анализа, теории вероятности, дискретной математики и теории алгоритмов в объеме первого курса.

\paragraph{Упражнения}

\begin{enumerate}
	\item Назовите основные задачи криптографии.
\item Что такое криптографический протокол?

\end{enumerate}


\chapter{Теория чисел}
\section{Модулярная арифметика}
Обозначим множества натуральных и целых чисел: 
$$N=\left\{1,2,3,\dots \right\},$$
$$Z=\left\{\dots ,-2,-1,0,1,2,\dots \right\}.$$

Если число $\frac{m}{n}$ целое число, то говорят, что $m$ делится на $n$ или, что $n$ является делителем числа $m$. Число $m$ называется кратным числа $n$, а $n$ делителем числа $m$.

Всякое целое число $m$ единственным образом представляется с помощью числа $n$ в виде
\[m=k\cdot n+r,\] 
где $k$, $r$ -- целые и $0\le r<b$. Число $k$ называется целой частью от деления $m$ на $n$, а $r$ остатком от деления $m$ на $n$.

Всякое целое, являющееся делителем чисел $m_1,m_2,\ldots,m_i$, называется их общим делителем. Наибольший среди общих положительных делителей этих чисел обозначается $\left(m_1,m_2,\dots ,m_i\right)$ и называется их наибольшим общим делителем.

Целое число, кратное всех данных чисел, называется их общим кратным. Наименьшее положительное общее кратное для набора чисел называется их наименьшим общим кратным.

Натуральное целое число отличное от 1 называется простым, если оно имеет только два делителя.

Два числа взаимно простые, если их наибольший общий делитель равен $1$.

Всякое натуральное число, большее $1$, разлагается на произведение простых чисел и единственным способом.

Представление числа $n$ в виде $n=p^{\alpha_1}_1\cdot p^{\alpha_2}_2\cdot \ldots\cdot  p^{\alpha_k}_k$, где $p_1,p_2,\ldots,p_k$~-- все простые делители числа $n$, называется каноническим разложение числа $n$.

Обозначим множества простых чисел:

\[P=\left\{2,3,5,7,11,13,17,19,21,23,\ldots \right\}.\] 

Говорят, что числа $a$ и $b$ сравнимы по модулю натурального числа $n$ и пишут $a=b\pmod n$, если $a-b$ делится на $n$, или, что то же самое, $a$ и $b$ имеют равные остатки от деления на $n$.

Через $a\pmod n$ обозначают остаток от деления $a$ на $n$ и называют вычетом по модулю $n$.


\paragraph{Упражнения}

\begin{enumerate}
\item  (Свойство ассоциативности умножения по модулю целого числа) Обозначим $a\cdot b\pmod n$ через $a*b$. Докажите, что $a*\left(b*c\right)=\left(a*b\right)*c$.

\item  Докажите, что если $a=b\pmod n$ и $b=c\pmod n$, то $a=c\pmod n$.

\item  Докажите, что из $a_1=b_1\pmod n$, $a_2=b_2\pmod n$, \dots, $a_k=b_k\pmod n$ следует $a_1+a_2+\ldots+a_k=b_1+b_2+\ldots+b_k\pmod n$.

\item  Докажите, что из $a_1=b_1\pmod n$, $a_2=b_2\pmod n$, \dots, $a_k=b_k\pmod n$ следует $a_1\cdot a_2\cdot \ldots\cdot a_k=b_1\cdot b_2\cdot \ldots\cdot b_k\pmod n$.

\item  Докажите, что если $a\cdot m=b\cdot m\pmod n$ и $(n,m)=1$, то $a=b\pmod n$

\item  Докажите, что из $a=b\pmod n$ для любого $k\in Z$ следует $a\cdot k=b\cdot k\pmod{n\cdot k}$.

\item  Докажите, что из $a\cdot k=b\cdot k\pmod{n\cdot k}$ следует $a=b\pmod n$.

\item  Докажите, что из $a=b\pmod{n_1}$, $a=b\pmod{n_2}$, \dots , $a=b\pmod{n_k}$ следует $a=b\pmod{n_1\cdot n_2\cdot \ldots \cdot n_k}$.

\item  Докажите, что из $a=b\pmod {n\cdot m}$ следует $a=b\pmod n$.

\item  Докажите, что если $a=b\cdot m\pmod {n\cdot m}$, то $a$ делится на $m$.

\item  Докажите, что если $a=b\pmod n$, то $(a,n)=(b,n)$.
\end{enumerate}


\section{Учебный алгоритм RSA.}

Алгоритм RSA -- алгоритм шифрования с открытым ключом или асимметричный алгоритм шифрования. Обмен информацией с помощью асиметричных алгоритмов шифрование в общих чертах осуществляется следующим образом. Пусть А и Б обмениваются конфиденциальной информацией. Для того, чтобы Б мог послать сообщение А, А необходимо сформировать открытый и закрытый ключ. Открытый ключ публикуется для всеобщего пользования, закрытый ключ держится в секрете. Б с помощью открытого ключа зашифровывает сообщение и отсылает его А. А с помощью закрытого ключа расшифровывает сообщение. 

Для формирование ключей А необходимо выполнить следующие действия:

\begin{enumerate}
\item  Выбрать два случайных простых числа $p$ и $q$. Простые числа должны быть приблизительно одинаковы по размеру.

\item  Вычислить модуль алгоритма RSA $n=p\cdot q$.

\item  Вычислить функцию Эйлера $\phi(n)$.

\item  Выбрать случайное целое число $e<\phi(n)$ такое, что $(e,\phi(n))=1$.

\item  Вычислить целое число $d$ такое, что $e\cdot d=1 \pmod{\phi(n)}$.

\item  Использовать пару чисел $(n,e)$ в качестве открытого ключа, а число $d$ в качестве закрытого (секретного) ключа, тщательно удалив при этом числа $p$, $q$и $\phi(n)$.
\end{enumerate}

Шифрование сообщения $m$ (сообщение представляет собой натуральное число $m<n$) происходит по формуле: $c=m^e\pmod n$.

Расшифровка зашифрованного сообщения $c$ происходит по формуле: $m=c^d\pmod n$.

Чтобы пользоваться алгоритмом RSA необходимо уметь:

\begin{enumerate}
\item  находить большие простые числа,

\item  находить число $d$, то есть решать уравнение $e\cdot d=1\pmod{\phi(n)}$,

\item  вычислять $m^e\pmod n$,

\item  вычислять функцию Эйлера.
\end{enumerate}

Необходимые алгоритмы представлены ниже. Запишем уравнение $e\cdot d=1\pmod\phi(n)$ в виде $a_1\cdot y=1\pmod{a_0}$, где $a_0$, $a_1$~-- известные коэффициенты, $y$~-- неизвестная переменная. Его решение находится из решения в целых числах уравнения: $a_0x+a_1y=1$, где $x,y$~-- неизвестные. Это уравнение можно решить, например, с помощью расширенного алгоритма Евклида или с помощью цепных дробей.


\section{Функция Эйлера}

Для натурального $n$ значение функции Эйлера $\phi(n)$ равно числу взаимно простых с $n$ чисел среди $\left\{1,2,\dots ,n-1\right\}$. Например, $\phi(5)$=4, поскольку среди чисел $\left\{1,2,3,4\right\}$ все взаимно просты с $5$, $\phi(6)=2$, поскольку среди чисел $\left\{1,2,3,4,5\right\}$ только числа $1$ и $5$ взаимно просты с $6$.

Представим число $n$ в виде канонического разложения $n=p^{\alpha_1}_1\ldots p^{\alpha_k}_k$, то есть разложение на простые множители, где $p_1,\ldots,p_k$~-- все простые попарно различные делители числа $n$, а $\alpha_1,\alpha_2,\ldots,\alpha_k$ отличные от нуля положительные целые числа.
В общем случае верна формула:

\[\phi(n)=n\left(1-\frac{1}{p_1}\right)\dots \left(1-\frac{1}{p_k}\right)\] 
Как следствие формулы получаем: если $n$ простое, то $\phi(n)=n-1$; если $p$ и $q$ простые числа, то $\phi(p\cdot q)=(p-1)(q-1)$.

\paragraph{Упражнения}

\begin{enumerate}
	\item Докажите, что если $(n,m)=1$, то $\phi(n\cdot m)=\phi(n)\cdot\phi(m)$.
		\item Докажите, что если $p$ -- простое, то $\phi(p^n)=p^{n-1}\left(p-1\right)$.
\end{enumerate}


\section{Алгоритм повторного возведения в квадрат}

Алгоритм повторного возведения в квадрат служит для вычисления числа $m^e\pmod n$. Идею алгоритма рассмотрим на примере вычисления числа $5^{16}\pmod{23}$. По определению

\[5^{16}\pmod{23}=5\cdot 5\cdot 5\cdot 5\cdot 5\cdot 5\cdot 5\cdot 5\cdot 5\cdot 5\cdot 5\cdot 5\cdot 5\cdot 5\cdot 5\cdot 5\pmod{23}\] 

Вычисление можно проводить последовательно, умножая промежуточный результат на число $5$ по модулю $23$ $15$ раз. Вычислим $5^2\pmod{23}=2$. Заметим, что теперь

\[5^{16}=2\cdot 2\cdot 2\cdot 2\cdot 2\cdot 2\cdot 2\cdot 2\pmod{23}\] 

Вычислим $2^2\pmod{23}=4$. Теперь

\[5^{16}=4\cdot 4\cdot 4\cdot 4\pmod{23}\] 

Вычислим $4^2\pmod{23}=16$. Теперь

\[5^{16}=16\cdot 16\pmod{23}\] 

Вычислим ${16}^2\pmod{23}=3$. Таким образом, $5^{16}=3\pmod{23}$, для вычисления чего мы сделали $4$ умножения по модулю $23$, а не $16$, как это было бы, если бы возведение в степень проводилось по определению.

Алгоритм повторного возведения в квадрат можно с таким же успехом для экономии вычислительных средств назвать и осуществлять как повторное возведение в куб и т.д.

Формализованный вариант алгоритма повторного возведения в квадрат для вычисления $m^e\pmod n$ выглядит так:

\begin{enumerate}
\item  Представим $e$ в двоичной системе счисления $e=e_02^r+\ldots +e_{r-1}2+e_r$, где $e_i$, цифры в двоичном представлении, равны 0 или 1, $e_0=1$.

\item  Положим $m_0=m$ и затем для $i=1,\ldots ,r$ вычислим $m_i=m^2_{i-1}\cdot m^{e_i}\pmod n$

\item  $m_r$ есть искомое $m^e\pmod n$. 
\end{enumerate}

Так как каждое вычисление на шаге 2 требует не более трех умножений по модулю $n$ и этот шаг выполняется $r\le log_2n$ раз, то сложность алгоритма может быть оценена величиной $O(\ln n)$.


\paragraph{Упражнение}

Запишите алгоритм на алгоритмическом языке, который вы знаете.


\section{Алгоритм Евклида}

Алгоритм Евклида служит для вычисления наибольшего общего делителя целых чисел. Пусть даны два натуральных числа $a_0$ и $a_1$, требуется найти их наибольший общий делитель $(a_0,a_1)$. Вычислим остаток от деления числа $a_0$ на $a_1$ и обозначим его $a_2$, т.е. $a_0=q_1a_1+a_2$, где $0\le a_2<a_1$, а $q_1$~-- целая часть деления $a_0/a_1$. Пусть теперь $a_3$~-- остаток от деления $\left(\frac{a_1}{a_2}\right)$, а $q_2$~--- целая часть $\left(\frac{a_1}{a_2}\right)$ и т.д., т.е. $a_{i+1}$~-- остаток от $\left(\frac{a_{i-1}}{a_i}\right)$, $q_{i+1}$~-- целая часть от $\left(\frac{a_{i-1}}{a_i}\right)$.

\paragraph{Упражнение}

\begin{enumerate}

\item  Покажите, что $(a_{i-1},a_i)=(a_i,a_{i+1})$. 

\item  Покажите, что для некоторого $n$ $a_{n+1}=0$, т.е.
\[(a_0,a_1)=(a_1,a_2)=\dots=(a_{i-1},a_i)=\dots=(a_n,0).\] 

\item  Покажите, что для $n$ из предыдущего упражнения 
\[(a_0,a_1)=a_n.\] 

\item  Подумайте, как теперь найти наибольший общий делитель чисел $a_0$ и $a_1$ и запишите алгоритм на алгоритмическом языке, который вы знаете. 
\end{enumerate}

\section[Расширенный алгоритм Евклида]{Расширенный алгоритм Евклида для решения целочисленных линейных уравнений}

Алгоритмом Евклида можно воспользоваться для решения целочисленного линейного уравнения $a_1y=1\pmod{a_0}$. Это уравнение будет решено, если решить в целых числах уравнение $a_0x+a_1y=1$. Уравнение $a_0x+a_1y=1$ имеет бесконечно много решений, если $(a_0,a_1)=1$, и ни одного, если $(a_0,a_1)\ne 1$. 

Воспользуемся введенными выше для алгоритма Евклида обозначениями.

Заметим, что $\left(a_i,a_{i+1}\right)=\left(a_{i-1},a_i\right)\left( \begin{array}{cc}
0 & 1 \\ 
1 & -q_i\end{array}
\right)$. 
Обозначим матрицу $\left( \begin{array}{cc}
0 & 1 \\ 
1 & -q_i \end{array}
\right)$ через $E_i$. Тогда 

\[(a_n,0)=(a_0,a_1)\cdot E_1\cdot E_2\cdot \dots \cdot E_n\] 

Пусть числа $a_0$ и $a_1$ взаимно простые, т.е. $(a_0,a_1)=a_n=1$ и пусть $\left( \begin{array}{cc}
x & z \\ 
y & w \end{array}
\right)=E_1\cdot E_2\cdot \dots \cdot E_n$. Тогда $\left(1,0\right)=\left(a_0,a_1\right)\left( \begin{array}{cc}
x & z \\ 
y & w \end{array}
\right)$, откуда $a_0x+a_1y=1$. Т.е., вычисление матрицы $E_1\cdot E_2\cdot \dots \cdot E_n$ позволяет найти одно решение уравнения $a_0x+a_1y=1$ в целых числах. 


\paragraph{Упражнение}

\begin{enumerate}
	\item Запишите алгоритм на алгоритмическом языке, который вы знаете.
	\item Если известно одно решение целочисленного уравнения $a_0x+a_1y=1$, как получить любое другое решение? Выведите формулу.
\end{enumerate}




\section[Цепные дроби]{Решение целочисленного уравнения $a_0y=1\pmod{a_1}$ с помощью цепных дробей.}

Пользуясь обозначениями, использованными в алгоритме Евклида, заметим, что

\[\frac{a_{i-1}}{a_i}=q_i+\frac{1}{\frac{a_i}{a_{i+1}}}\] 

Таким образом,

\[\frac{a_0}{a_1}=q_1+\frac{1}{q_2+\frac{1}{q_3+\dots +\frac{1}{q_n}}}=q_1+\frac{1}{q_2+\frac{1}{q_3+\frac{1}{\frac{\dots }{q_n}}}}\] 

Такая запись дроби $\frac{a_0}{a_1}$ называется разложением в цепную (или непрерывную) дробь. Другая ее запись: $\frac{a_0}{a_1}=\left[q_1;q_2,q_3,\dots ,q_n\right]$.

Обозначим

\[\delta_1=q_1\] 
\[\delta_2=q_1+\frac{1}{q_2}\] 
\[\delta_3=q_1+\frac{1}{q_2+\frac{1}{q_3}}\] 
\[\ldots \] 
\[\delta_i=[q_1;q_2,q_3,\dots ,q_i]\] 
\[\ldots \] 
\[\delta_n=[q_1;q_2,q_3,\dots ,q_n]\] 
Величины $\delta_i$ называются подходящими дробями. Обозначим $P_0=1$, $Q_0=0$, $P_1=q_1$, $Q_1=1$. Заметим, что $\delta_i$получается из ${\delta }_{i-1}$ заменой $q_{i-1}$на $q_{i-1}+\frac{1}{q_i}$, поэтому

\[{\delta }_1=\frac{q_1}{1}=\frac{P_1}{Q_1}\] 
%
\[\delta_2=q_1+\frac{1}{q_2}=\frac{q_1q_2+1}{q_2}=\frac{P_1\cdot q_2+P_0}{Q_1\cdot q_2+Q_0}=\left\{ \begin{array}{c}
P_2=P_1\cdot q_2+P_0 \\ 
Q_2=Q_1\cdot q_2+Q_0 \end{array}
\right\}=\frac{P_2}{Q_2}\] 
%
\[\delta_3=\frac{P_1\cdot \left(q_2+\frac{1}{q_3}\right)+P_0}{Q_1\cdot \left(q_2+\frac{1}{q_3}\right)+Q_0}=\frac{P_2\cdot q_3+P_1}{Q_2\cdot q_3+Q_1}=\left\{ \begin{array}{c}
P_3=P_2\cdot q_3+P_1 \\ 
Q_3=Q_2\cdot q_3+Q_1 \end{array}
\right\}=\frac{P_3}{Q_3}\] 

Если далее положить: 
\[P_i=P_{i-1}\cdot q_i+P_{i-2}\] 
\[Q_i=Q_{i-1}\cdot q_i+Q_{i-2}\] 
можно показать, что
\[\delta_i=\frac{P_i}{Q_i}\] 
Умножим правую и левую часть равенства $P_i=P_{i-1}\cdot q_i+P_{i-2}$ на $Q_{i-1}$. Аналогично умножим правую и левую часть равенства $Q_i=Q_{i-1}\cdot q_i+Q_{i-2}$ на $P_{i-1}$. Получим
\[P_iQ_{i-1}=P_{i-1}Q_{i-1}q_i+P_{i-2}Q_{i-1}\] 
\[P_{i-1}Q_i=P_{i-1}Q_{i-1}q_i+P_{i-1}Q_{i-2}\] 
Отнимем от верхнего равенства нижнее, получим:
\[P_iQ_{i-1}-{P_{i-1}Q}_i=P_{i-2}Q_{i-1}-{P_{i-1}Q}_{i-2}\] 
Таким образом, имеем:
\[P_iQ_{i-1}-{P_{i-1}Q}_i=-({P_{i-1}Q}_{i-2}-P_{i-2}Q_{i-1})\] 
\[{P_{i-1}Q}_{i-2}-P_{i-2}Q_{i-1}=-({P_{i-2}Q}_{i-3}-P_{i-3}Q_{i-2})\] 
\[\dots \] 
\[{P_2Q}_1-P_1Q_2=-({P_1Q}_0-P_0Q_1)\] 
\[{P_1Q}_0-P_0Q_1=-1\] 
Отсюда получаем формулу:
\[P_iQ_{i-1}-{P_{i-1}Q}_i=(-1)^i\] 
Поскольку 
$\delta_n=\frac{a_0}{a_1}=\frac{P_n}{Q_n}$, то из $P_nQ_{n-1}-P_{n-1}Q_n=(-1)^n$ следует $a_0Q_{n-1}-P_{n-1}a_1=(-1)^n$, т.е. 
\[a_0(-1)^nQ_{n-1}+a_1(-1)^{n+1}P_{n-1}=(-1)^n\] 
\[a_0Q_{n-1}=(-1)^n\pmod{a_1}\] 
\[a_0(-1)^nQ_{n-1}=1\pmod{a_1}\] 

Значит, одним из решений уравнения $a_0x+a_1y=1$ является
\[x=(-1)^nQ_{n-1}\] 
\[y=(-1)^{n+1}P_{n-1}\] 

Решениями уравнения

\[a_1y=1\pmod{a_0}\] 

являются $y=(-1)^{n+1}P_{n-1}+k\cdot a_0$, $k\in Z$. 


\paragraph{Упражнение}


\begin{enumerate}
	\item Покажите, что уравнение $a_0x+a_1y=1$ решается в целых числах тогда и только тогда, когда $(a_0,a_1)=1$.
	\item Покажите, что знаменатель и числитель $i$-ой подходящей дроби образуют несократимую дробь $\frac{P_i}{Q_i}$.
\end{enumerate}

\section[Тест Рабина-Миллера]{Как отличить простое число от составного}

При формировании ключей в алгоритме RSA необходимо выбрать два больших простых числа. Это можно сделать следующим образом. Выбирается случайно большое число и проверяется, является ли оно составным или простым. Если оно простое, то мы его берем, если же оно оказывается составным, мы его отбрасываем и берем новое случайное число. Процесс повторяем до тех пор, пока не найдем простое число. Этот процесс достаточно быстро закончится по двум причинам. Во-первых, существуют хорошие алгоритмы, проверяющие является ли число простым. Например, эту задачу практически приемлемо решает вероятностный алгоритм Рабина-Миллера, приведенный ниже. Во-вторых, простых чисел достаточно много, среди натуральных чисел в диапазоне от 1 до $n$ существует приблизительно $\frac{n}{\ln n}$ простых чисел, то есть существует большая вероятность того, что произвольно выбранное число окажется простым.

В 1976 г. Миллером был предложен следующий алгоритм проверки простоты числа. Если $n$ - простое число, $n-1=2^s\cdot t$, где $t$ нечетное, то согласно малой теореме Ферма, о которой будет сказано в следующих разделах, для каждого $a$ с условием $(a,n)=1$ хотя бы одна из скобок в произведении $\left(a^t-1\right)\left(a^t+1\right)\left(a^{2t}+1\right)\cdot \ldots \cdot \left(a^{2^{s-1}t}+1\right)=a^{n-1}-1$ делится на $n$. Обращение этого свойства можно использовать, чтобы отличать составные числа от простых. 

Пусть $n$~-- нечетное составное число, $n-1=2^s\cdot t$, где $t$ нечетно. Назовем целое число $a$, $1<a<n$, "`хорошим"' для $n$, если нарушается одно из двух условий: 



\begin{description}
\item[a)]\label{a}  $n$ не делится на $a$;

\item[b)]\label{b}  $a^t=1\pmod n$ или существует целое $k$, $0\le k<s$, такое, что $a^{2^kt}=-1\pmod n$.
\end{description}

Из сказанного ранее следует, что для простого числа $n$ не существует хороших чисел $a$. Если же $n$ составное число, то, как доказал Рабин, их существует не менее $\frac{3}{4}\left(n-1\right)$. 

Теперь можно построить вероятностный алгоритм, отличающий составные числа от простых.

Алгоритм Миллера-Рабина, доказывающий непростоту числа:

\begin{enumerate}
\item  Выберем случайным образом число $a$, $1<a<n$, и проверим для этого числа указанные выше свойства~a) и b). 

\item  Если хотя бы одно из них нарушается, то число $n$ составное. 

\item  Если выполнены оба условия a) и b), возвращаемся к шагу 1. 
\end{enumerate}

Из сказанного выше следует, что составное число не будет определено как составное после однократного выполнения шагов 1-3 с вероятностью не большей $\frac{1}{4}$. А вероятность не определить его как составное после $k$ повторений не превосходит $\frac{1}{4^k}$, т.е. убывает очень быстро.

Особенностью вероятностного алгоритма Рабина-Миллера является возможность ошибки~-- принять неправильный результат его работы за правильный Такие алгоритмы называются вероятностными алгоритмами типа Монте-Карло. Позже мы познакомимся еще с одним вероятностным алгоритмом, с другой особенностью: результат его работы всегда правильный ответ, но время его работы с некоторой вероятностью может оказаться непредсказуемо долгим. Такие вероятностные алгоритмы называются алгоритмами типа Лас-Вегаса. Как в случае алгоритмов Монте-Карло, так и в случае алгоритмов Лас-Вегаса, можно добиться практически ничтожной вероятности их нежелательного поведения, то есть первый с вероятностью практически равной 1 будет давать правильный ответ, а другой с вероятностью практически равной 1 работать полиномиальное время, то есть быстро.

\paragraph{Упражнения}


\begin{enumerate}
	\item Вычислите вероятность того, что произвольно выбранное число состоящее из 100 цифр будет простым?
	\item Проведите тест Рабина-Миллера для чисел $37$, $41$, $51$ так, чтобы вероятность ошибки была меньше $1/4$.
\end{enumerate}

\chapter{Алгебра}

\section{Конечные группы}

Если внимательно посмотреть на две таблицы умножения: умножения по модулю 7 чисел $\{1,2,3,4,5,6\}$ и по модулю 6 чисел $\{1,2,3,4,5\}$, 

	\begin{tabular}[t]{|c|c|c|c|c|c|c|}
	\hline
	$\cdot\pmod 7$& 1 & 2 & 3 & 4 & 5 & 6\\ 
	\hline
	1 & 1 & 2 & 3 & 4 & 5 & 6 \\ 
	\hline
	2 & 2 & 4 & 6 & 1 & 3 & 5 \\
	\hline
	3 & 3 & 6 & 2 & 5 & 1 & 4 \\
	\hline
	4 & 4 & 1 & 5 & 2 & 6 & 3 \\
	\hline
	5 & 5 & 3 & 1 & 6 & 4 & 2 \\
	\hline
	6 & 6 & 5 & 4 & 3 & 2 & 1 \\
	\hline
	\end{tabular}
	\begin{tabular}[t]{|c|c|c|c|c|c|}
	\hline
	$\cdot\pmod 6$& 1 & 2 & 3 & 4 & 5\\ 
	\hline
	1 & 1 & 2 & 3 & 4 & 5 \\ 
	\hline
	2 & 2 & 4 & 0 & 2 & 4 \\
	\hline
	3 & 3 & 0 & 3 & 0 & 3 \\
	\hline
	4 & 4 & 2 & 0 & 4 & 2 \\
	\hline
	5 & 5 & 4 & 3 & 2 & 1 \\
	\hline

	\end{tabular}

\noindent
можно увидеть их принципиальное отличие. Например, в таблице для операции умножения по модулю 7 в любом столбце и любой строке находятся все рассматриваемые числа $\{1,2,3,4,5,6\}$. Это свойство позволяет решать уравнения относительно умножения по модулю 7. Обозначим умножение по модулю 7 через $*$. Тогда, например, уравнение $4*x=5$ имеет решение $x=3$, при чем оно единственное, а уравнение $x*5=2$ имеет решение и тоже единственное $x=6$. Умножение же по модулю 6 не обладает аналогичным свойством. Например, уравнение $3\cdot x = 2 \pmod 6$ не имеет решений, а уравнение $3\cdot x = 3 \pmod 6$ имеет несколько решений. Умножение по модулю 6 на числах $\{1,2,3,4,5\}$ в строгом смысле не является операцией, поскольку в таблице умножения встречается 0, которого нет в $\{1,2,3,4,5\}$. А вот умножение по модулю 7 на множестве $\{1,2,3,4,5,6\}$ является операцией в точном смысле слова, обладая при этом свойствами обычной, привычной со школы, операции умножения действительных чисел, для которой все ещё со школы умеют решать уравнения вида $a\cdot x=b$ и $x\cdot a=b$, если при этом $a\neq 0$. 

Приведём ещё примеры. Если построить таблицы для операций сложения по модулю 7 на числах $\{0,1,2,3,4,5,6\}$ и сложения по модулю 6 на числах $\{0,1,2,3,4,5\}$, можно увидеть что и они обладают аналогичными свойствами решения уравнений, как и операция умножения по модулю 7.

Посмотрим еще раз на таблицу умножения по модулю 7. По ней видно, что операция обладает так называемым нейтральным элементом 1, уникальное свойство которого следующее: какое бы мы число $a$ из $\{1,2,3,4,5,6\}$ ни взяли, всегда будет верно $1*a=a*1=a$. Более того 1 стоит в каждой строке и каждом столбце таблицы; а это значит, что какое бы мы число $a$ из $\{1,2,3,4,5,6\}$ ни взяли, всегда найдется число $b$ из $\{1,2,3,4,5,6\}$ такое, что $a*b=b*a=1$. Такое число $b$ называется обратным к $a$ относительно операции $\cdot\pmod 7$. Понятно, что и $a$ и обратно к $b$ в этом смысле. Существование нейтрального элемента и обратного относительно операции $*$ достаточно для существования и единственности решений уравнений вида $a*x=b$. Чтобы решить уравнение $a*x=b$ достаточно найти обратный к $a$ элемент $c$. Тогда, чтобы решить уравнение, можно проделать следующее: $c*a*x=c*b$, $1*x=c*b$, $x=c*b$.

Мы пришли к важному алгебраическому понятию группа: множество с операцией, относительно которой можно решать уравнения. Теперь дадим точные определения.


\begin{definition}
Множество с определенной на нём операцией называется полугруппой, если операция является ассоциативной.
\end{definition}

Другими словами полугруппа -- это пара $\left(M,*\right)$, где $M$ -- множество, $*$ - бинарная операция на множестве $M$, обладающая ассоциативным свойством: $$\forall a,b,c\in M\left[a*(b*c)=(a*b)*c\right].$$

\begin{definition}
Множество с определенной на нём операцией называется группой, если операция является ассоциативной, существует нейтральный элемент и для каждого элемента множества существует ему обратный.
\end{definition}

Другими словами, группа~-- это пара $(M,*)$, где $M$~-- множество, $*$~-- бинарная операция на множестве $M$, которая удовлетворяет следующим свойствам: 

\begin{enumerate}
\item  Ассоциативный (сочетательный) закон: $$\forall a,b,c\in M\left[a*\left(b*c\right)=\left(a*b\right)*c\right]$$

\item  Существует нейтральный элемент: $$\exists e\in M\forall a\in M[a*e=e*a=a]$$

\item  Существует обратный элемент:  $$\forall a\in M\exists b\in M[a*b=b*a=e]$$
\end{enumerate}
Группу $(M,*)$ будем иногда обозначать просто $M$.

Функция, ставящая в соответствие элементу его обратный обычно обозначают через $x^{-1}$, т.е. обратный к $a\in M$ обозначают обычно через $a^{-1}$. Такая функция является унарной операцией. Нейтральный элемент принято рассматривать как нульарную операцию (константную функцию, константу), результатом которой является $e$. 

Если операцию называют умножением и обозначают точкой, то нейтральный элемент принято называть единицей и обозначать 1. Если операцию называют сложением и обозначают $+$, то нейтральный элемент называют нулем и обозначают 0, а обратный элемент называют противоположным. При этом противоположный элемент к$a\in M$ обозначают через $-a$.

\paragraph{Упражнение} Покажите, что нейтральный элемент в группе единственный.
\paragraph{Упражнение} Покажите, что для каждого элемента в группе существует единственный обратный к нему элемент.

В группе можно решать уравнения вида $a*x=b$ и $x*a=b$. Например, решение уравнения $a*x=b$ получается таким образом:

\[a*x=b\Leftrightarrow a^{-1}*a*x=a^{-1}*b\Leftrightarrow e*x=a^{-1}*b\Leftrightarrow x=a^{-1}*b\] 

Аналогично можно получить решение $x=b*a^{-1}$уравнения $x*a=b$.

Группа называется абелевой или коммутативной, если в ней выполняется коммутативный (переместительный) закон:

\begin{enumerate}
\item  Коммутативный (переместительный) закон: \[\forall a,b\in M[a*b=b*a].\]
\end{enumerate}



В коммутативной группе уравнения $a*x=b$ и $x*a=b$ эквивалентны, то есть имеют одно и то же решение. Поэтому в коммутативной группе $(M,*)$ можно ввести обратную операцию. Если операция называется умножением, то обратная  называется делением. Если операция называется сложением, то обратная называется вычитанием. Например, если операция $*$ называется умножением, то под делением $\frac{a}{b}$ понимается решение уравнения $a*x=b$.

Иногда группу $(M,*)$ рассматривают как множество с тремя операциями, понимая при этом нейтральный элемент как $0$-арную операцию, а соответствие $x^{-1}$ элементу $x$ его обратного как унарную операцию. Таким образом, группа есть фактически множество с тремя операциями.

Если число элементов группы конечно, то группа называется конечной. 

\begin{definition}
Порядком конечной группы называется число элементов в группе.
\end{definition}

\begin{definition}
Порядком элемента $a$ группы $(M,*,1)$ называется минимальное натуральное число $n$ такое, что 
$$a^n=\overbrace{a*a*...*a}^{\mbox{$n$ раз}}=1.$$
\end{definition}

\begin{definition}
Пусть $(M,*,1)$ группа, $M'\subseteq M$ и $(M',*,1)$~-- группа с той же операцией, что в $(M,*,1)$, тогда $(M',*,1)$ называется подгруппой группы $(M,*,1)$.
\end{definition}

\begin{definition}
Группа называется циклической, если в ней есть элемент, порядок которой совпадает с порядком группы.
\end{definition}

\begin{definition}
Если порядок элемента группы совпадает с порядком группы, то такой элемент называют генератором или образующим элементом группы.
\end{definition}

Пример. Пусть $n$ порядок элемента $a$ в группе $\left(M,*,1\right)$, тогда множество элементов $\left\{{1,a}^1,a^2,\dots ,a^{n-1}\right\}$ образуют циклическую подгруппу группы $\left(M,*,1\right)$.

\begin{theorem}
 (Теорема Лагранжа) Порядок любой подгруппы конечной группы делит порядок группы.
\end{theorem}

Богатая важными следствиями теорема Лагранжа является одной из центральных в теории групп. Поэтому приведем её доказательство.

{\bf Доказательство} теоремы Лагранжа.

Пусть произовльная подгруппа $H$ группы $G$ состоит из элементов $\left\{h_1,h_2,\dots ,h_m\right\}$. Пусть $h_1=e$ -- нейтральный элемент. Построим строку за строкой следующую таблицу, состоящую из $m$ столбцов. Первой строкой таблицы будут все элементы подгруппы $H$:

\[e,h_2,\dots ,h_m\] 

Заметим, что в этой строке нет одинаковых элементов. Возмем произвольный элемент $g_1$ группы $G$ еще не встречающийся в таблице и добавим к таблице строку, состоящую из произведений $g_1$ на первую строку:

\[ \begin{array}{cccc}
e, & h_2, & \dots , & h_m \\ 
g_1 & g_1*h_2 & \dots , & g_1*h_m \end{array}
\] 

Если в этой таблице встречаются не все элементы группы $G$, то продолжим. Возмем элемент $g_2$ группы $G$ еще не встречающийся в таблице и добавим к таблице строку, состоящую из произведений $g_2$ на первую строку:

\[ \begin{array}{cccc}
e, & h_2, & \dots , & h_m \\ 
g_1, & g_1*h_2, & \dots , & g_1*h_m \\ 
g_2, & g_2*h_2, & \dots , & g_2*h_m \end{array}
\] 

Продолжим добавление строк до тех пор, пока в таблице не будут находиться все элементы группы $G$. Это когда-нибудь произойдет потому, что группа конечная.

Пусть в результате получена таблица с $k$ строками:

\[ \begin{array}{cccc}
e, & h_2, & \dots , & h_m \\ 
g_1, & g_1*h_2, & \dots , & g_1*h_m \\ 
g_2, & g_2*h_2, & \dots , & g_2*h_m \\ 
\dots , & \dots , & \dots , & \dots , \\ 
g_k, & g_k*h_2, & \dots , & g_k*h_m \end{array}
\] 

Докажем от противного, что ни одна строка не содержит одинаковых элементов. Предположим, что это не так и, например, $i$-ая строка содержит два равных элемента во $j$-м и $l$-м столбце, то есть $g_i*h_j=g_i*h_l$. Но тогда $h_j=h_l$~-- противоречие.

Докажем теперь от противного, что в таблице в разных строках нет одинаковых элементов. Предположим что это не так и для некоторых строк $i$ и $j$ и элементов $h$, $h'\in H$ в таблице $g_i*h=g_j*h'$. Пусть $j<i$. Но, поскольку $g_i=g_j*h'*h^{-1}$ и $h'*h^{-1}$ является элементом подгруппы $H$, то $g_i$ уже есть в строке $j$, что противоречит алгоритму построения таблицы.

Таким образом, мы показали, что в таблице нет одинаковых элементов и она содержит все элементы группы $G$. То есть порядок группы равен $k\cdot m$ и, значит, порядок подгруппы делит порядок группы. Что и требовалось доказать. 

\begin{corollary}
Порядок элемента делит порядок группы.
\end{corollary}

\begin{corollary}
(Теорема Эйлера) Пусть $a$ и $n$ взаимно простые натуральные числа. Тогда $a^{\phi(n)}=1\pmod n$.
\end{corollary}


{\bf Доказательство.} Рассмотрим множество $\left\{b_1,b_2,\dots ,b_{\phi(n)}\right\}$ всех взаимно простых с $n$ чисел из множества $\left\{1,2,\dots ,n-1\right\}$. Пусть $a,b\in \left\{b_1,b_2,\dots ,b_{\phi(n)}\right\}$. Рассмотрим число $c=a\cdot b \pmod n$. Если оно имеет общие делители с $n$, то и $a\cdot b$ имеет общие делители с $n$, что невозможно, поскольку $a$ и $b$ взаимно просты с $n$. Таким образом, $c\in \left\{b_1,b_2,\dots ,b_{\phi(n)}\right\}$. Покажем, что для любого $a\in \left\{b_1,b_2,\dots ,b_{\phi(n)}\right\}$:
\[\{b_1\cdot a,b_2\cdot a,\ldots,b_{\phi(n)}\cdot a\}=\{b_1,b_2,\dots ,b_{\phi(n)}\}\] 
то есть все числа $\{b_1\cdot a,b_2\cdot a,\dots,b_{\phi(n)}\cdot a\}$ попарно различны. Предположим это не так и для некоторых $b,b'\in\{b_1,b_2,\dots,b_{\phi(n)}\}$ выполняется $a\cdot b\pmod n=a\cdot b'\pmod n$. Но тогда $a\cdot(b-b')=0 \pmod n$ и, значит, $a\cdot(b-b')$ делится на $n$ без остатка, но это невозможно, поскольку $a$ взаимно простое с $n$, а $b-b'$ меньше $n$.

Таким образом, мы показали, что множество $\{b_1,b_2,\dots ,b_{\phi(n)}\}$ с операцией умножения по модулю $n$ является группой порядка $\phi(n)$. Из теоремы Лагранжа следует требуемое утверждение.

\begin{corollary}
(Малая теорема Ферма) Пусть $n$ простое число. Тогда для любого числа $a\in\{1,2,\dots,n-1\}$ верно следующее равенство $a^{n-1}=1 \pmod n$.
\end{corollary}

{\bf Доказательство.} По условию теоремы и формуле для вычисления функции Эйлера получаем $\phi(n)=n-1$. Из теоремы Эйлера теперь следует требуемое утверждение.

\begin{definition}
Пусть $a$, $b$ являются элементами группы $(M,*,1)$. Тогда под дискретным логарифмом $\log_a b$ элемента $b$ по основанию $a$ в группе $(M,*,1)$ называется такое минимальное натуральное число $i$, что $a^i=b$.
\end{definition}

Множество целых чисел $\left\{1,2,\dots ,\ p-1\right\}$ c операцией умножения по модулю числа $p$ образуют группу, если $p$~-- простое число. Такую группу обозначают $Z^*_p$. Если $p$ не является простым числом, то операция умножения по модулю $p$ не является групповой операцией на множестве $\{1,2,\dots,p-1\}$.

Важное замечание. Для некоторых групп, в частности для группы $Z^*_p$, в случае, когда порядок элемента $a$ является относительно большим числом, вычисление дискретного логарифма является вычислительно сложной (практически неразрешимой) задачей.

\section{Кольца и поля}

\begin{definition}
Кольцом$(M,\cdot,+)$ называется множество $M$ с двумя операциями $\cdot$ (умножение) и $+$ (сложение) такими, что:

\begin{enumerate}
\item  $(M,+)$ - является коммутативной группой (она называется аддитивной группой поля);

\item  $(M,\cdot)$- является полугруппой;

\item  выполняется дистрибутивный (распределительный) закон: 
$$\forall a,b,c\in M\left[a\cdot(b+c)=(a\cdot b)+(a\cdot c)\right]$$
$$\forall a,b,c\in M\left[(b+c)\cdot a=(b\cdot a)+(c\cdot a)\right]$$
\end{enumerate}

\end{definition}


\begin{definition}
Полем $(M,\cdot,+)$ называется множество с двумя операциями $\cdot$ (умножение) и $+$ (сложение) такими, что:

\begin{enumerate}
\item  $(M,+)$ -- является коммутативной группой (она называется аддитивной группой поля),

\item  $(M-\{0\},\cdot)$- является коммутативной группой (называется мультипликативной группой поля), где $0$~-- нейтральный элемент группы $(M,+)$

\item  выполняется дистрибутивный (распределительный) закон: 
$$\forall a,b,c\in M\left[a\cdot(b+c)=(a\cdot b)+(a\cdot c)\right]$$

\end{enumerate}

\end{definition}

Нейтральный элемент мультипликативной группы поля обозначается 1.

Если число элементов в поле конечно, то поле называется полем Галуа. Число элементов в конечном поле называется порядком поля. Если порядок поля равен $n$, то поле обозначается $GF(n)$.

Два поля называются изоморфными, если одно из другого можно получить переименованием элементов.

Теорема. Два поля одного порядка изоморфны.

Пример поля: $GF(2)=(\{0,1\},*,\star)$, где $*=\cdot mod\ 2$, $\star =+mod\ 2$

Теорема. Порядок поля всегда имеет вид $p^m$, где $p$~-- простое число, $m$~-- натуральное.

Кольцо многочленов над полем $G??\left(p\right)$.

Формально многочленом степени $n$ над полем $GF\left(p\right)$ является математической выражение:

\[a_nx^n+a_{n-1}x^{n-1}+\dots +a_1x+a_0\] 

где $x$ называется переменной, а коэффициенты принадлежат полю $GF\left(p\right)$.




\end{document}
