Пусть $G$~-- группа и $a,b\in G$. Решение уравнения $a^x=b$ в натуральных числах в группе $G$ называется дискретным логарифмом элемента $b$ по основанию $a$ и, если дискретный логарифм существует, то он обозначается $\log_ab$. Другими словами, дискретный логарифм $\log_ab$ это натуральное число такое, что $a^{\log_ab}=b$.
Если порядок $n$ элмента $a$ конечен, то  в силу следствий из теоремы Лагранжа $a^{x+n}=a^{x}$ и уравнение $a^x=b$ имеет бесконечно много решений. Под $\log_ab$ обычно понимают минимальное решение уравнения $a^x=b$, т.е.   $1\le\log_ab\le n$.

Есть разновидности групп, для которых, в общем случае, до сих пор не известны полиномиальные по времени алгоритмы решения задачи дискретного логарифмирования. К таким группам, например, относятся $Z_p^*=\left(\{1,2,\ldots,p-1\},\cdot\pmod p\right)$, где $p$~-- простое число, а также группы на эллиптических кривых. Однако для простых чисел $p$ таких, что $p-1$ раскладывается на небольшие простые множители порядка $\log p$, задача дискретного логарифмирования решается за полиномиальное время, например, с помощью алгоритма Полига-Хеллмана. Примером подходящих простых чисел служат числа вида $p=2^{n_1}3^{n_2}+1$.

Рассмотрим уравнение $a^x=b\pmod p$ в группе $Z_p^*$, где $p\in P$. Далее предполагаем, что порядок элемента $a$ равен $p-1$. Пусть $p=q_1^{n_1}q_2^{n_2}\ldots q_k^{n_k}+1$, где $q_1,q_2,\ldots,q_k$~-- попарно различные простые числа.

Алгоритм Полига-Хеллмана состоит из трёх этапов. На первом этапе вычисляются числа $r_{q,i}=a^{i(p-1)/q}\pmod p$ для всех $q\in \{q_1,q_2,\ldots,q_k\}$ и $i\in\{0,1,2,\ldots,q-1\}$, т.е. для каждого $q$ строим таблицу:


\begin{table}[htbp]
	\centering
\begin{tabular}[t]{|r|c|c|c|c|c|}
\hline
           $i=$  &           $0$    &            $1$   & $\ldots$   & $q-1$               \\ \hline 
$a^{i(p-1)/q}\pmod{p}=$  &$a^{0(p-1)/q}$    & $a^{1(p-1)/q}$   & $\ldots$   & $a^{(q-1)(p-1)/q}$  \\ \hline 
\end{tabular}
	\caption{Таблица алгоритма Полига-Хеллмана для простого числа $q$}
	\label{tab:ph}
\end{table}

На втором этапе для каждого $i\in\{1,2,\ldots,k\}$ находим $\log_ab\pmod{q_i^{n_i}}$. Делается это следующим образом. Пусть для простоты $q=q_i$ и $n=n_i$.
Пусть
\[
x=\log_ab=x_0+x_1q+\ldots+x_{n-1}q^{n-1}\pmod{q^n},
\]
%x=\log_ab\pmod{q^n}=x_0+x_1q+\ldots+x_{n-1}q^{n-1}\pmod{q^n},
где $0\le x_i< q$. Заметим, что тогда
\[
x=x_0+x_1q+\ldots+x_{i}q^{i}\pmod{q^{i+1}},
\]
для всех $i< n$.
Отcюда следует
\[
x-x_0-x_1q-\ldots-x_{i-1}q^{i-1}=x_iq^i\pmod{q^{i+1}}.
\]
и далее
\[
(x-x_0-x_1q-\ldots-x_{i-1}q^{i-1})(p-1)/q^{i+1}=x_i(p-1)/q\pmod{p-1}.
\]
Поскольку  $a^x=b\pmod p$, то
\[
a^{x-x_0-x_1q-\ldots-x_{i-1}q^{i-1}}=ba^{-x_0-x_1q-\ldots-x_{i-1}q^{i-1}}\pmod p.
\]
и
\begin{equation}\label{eq:ph}
a^{x_i(p-1)/q}=\left(ba^{-x_0-x_1q-\ldots-x_{i-1}q^{i-1}}\right)^{\left(p-1\right)/q^{i+1}}\pmod p.
\end{equation}
В частности, при $i=0$, имеем

\begin{equation}\label{eq:x0}
b^{(p-1)/q}=a^{x_0(p-1)/q}\pmod p.	
\end{equation}
Из равенства~\ref{eq:x0} и таблицы~\ref{tab:ph} находим значение $x_0$.
Далее, по индукции, зная значения $x_0$, $x_1$, $\ldots$, $x_{i-1}$, число $x_i$ находим из таблицы~\ref{tab:ph} и
сравнения~\ref{eq:ph}.


На третьем, последнем, этапе, зная значения $\log_ab\pmod{q_i^{n_i}}$ для всех $i\in\{1,2,\ldots,k\}$, находим $\log_ab\pmod{p-1}$
по китайской теореме об остатках.

\subsection*{Пример}
Решим с помощью алгоритма Полига-Хеллмана уравнение $5^x=32\pmod{73}$. Поскольку $73=2^33^2+1$, то, согласно первому этапу алгоритма, строим две следующие таблицы:
\begin{table}[htbp]
	\centering
\begin{tabular}[t]{|r|c|c|}
\hline
      $i=$  & $0$ &  $1$   \\ \hline 
$5^{36i}\pmod{73}=$  & $1$ &  $72$  \\ \hline 
\end{tabular}
	\caption{Таблица значений $a^{i(p-1)/q}$, где $a=5$, $p-1=72$, $q=2$.}
	\label{tab:ph2}
\end{table}
\begin{table}[htbp]
	\centering
\begin{tabular}[t]{|r|c|c|c|}
\hline
      $i=$  & $0$ &  $1$  & $2$ \\ \hline 
$5^{24i}\pmod{73}=$  & $1$ &  $8$  & $64$ \\ \hline 
\end{tabular}
	\caption{Таблица значений $a^{i(p-1)/q}$, где $a=5$, $p-1=72$, $q=3$.}
	\label{tab:ph3}
\end{table}

Теперь найдём $\log_{5}(32)\pmod{2^3}$ и $\log_{5}(32)\pmod{3^2}$. Положим $\log_{5}(32)=x_0+2x_1+2^2x_2\pmod{2^3}$. Тогда, по формуле~\ref{eq:ph} и таблице~\ref{tab:ph2} последовательно находим $x_0$, $x_1$, $x_2$:
\[
\begin{array}{lcc}
5^{x_{0}36}=32^{36}=1\pmod {73} 											& \Rightarrow & x_0=0, \\	
5^{x_{1}36}=(32\cdot 5^{-0})^{18}=1\pmod {73}				  & \Rightarrow & x_1=0, \\
5^{x_{2}36}=(32\cdot 5^{-0-0\cdot 2})^{9}=1\pmod {73} & \Rightarrow & x_2=0. \\
\end{array}
\]

Таким образом, $\log_{5}(32)=0\pmod{2^3}$. Положим теперь $\log_{5}(32)=x_0+3x_1\pmod{3^2}$. Тогда, по формуле~\ref{eq:ph} и таблице~\ref{tab:ph3} последовательно находим $x_0$, $x_1$:
\[
\begin{array}{lcc}
5^{x_{0}24}=32^{24}=8\pmod {73} & \Rightarrow & x_0=1, \\	
5^{x_{1}24}=(32\cdot 5^{-1})^{8}=(32\cdot 44)^{18}=21^{8}=8\pmod {73} & \Rightarrow & x_1=1. \\	
\end{array}
\]
Таким образом, $\log_{5}(32)=4\pmod{3^2}$. Теперь  по китайской теореме об остатках, решая систему
\[
\left\{
\begin{array}{lcc}
\log_{5}(32)=0\pmod{2^3} \\
\log_{5}(32)=4\pmod{3^2}, \\
\end{array}
\right.
\]
найдем $\log_{5}(32)=40\pmod{72}$.

Ответ: $40$.






\subsection*{Упражнение}

Оцените сложность алгоритма Полига-Хеллмана.
