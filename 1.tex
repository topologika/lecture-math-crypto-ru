
\begin{equation*}
\frac{\mathit{lo}g_2n-H_L}{\mathit{lo}g_2n}=1-\frac{H_L}{\mathit{lo}g_2n}
\end{equation*}
{в некотором смысле показывает, какую часть букв открытого текста можно опустить без потери содержания. Имеется в виду, что потерянная информация будет восстановлена другими буквами сообщения вследствие закономерностей языка.}

{Согласно исследованиям Б.Б. Пиотровского имеют следующие приближения величины } $H_L$:

\begin{flushleft}
\tablefirsthead{}
\tablehead{}
\tabletail{}
\tablelasttail{}
\begin{supertabular}{|m{3.157cm}|m{1.04cm}|m{1.2019999cm}|m{1.058cm}|m{1.222cm}|}
\hline
~ &
\multicolumn{2}{m{2.442cm}|}{{Энтропия языка}} &
\multicolumn{2}{m{2.48cm}|}{{Избыточность}}\\
~ &
\multicolumn{2}{m{2.442cm}|}{({бит/букву)}} &
\multicolumn{2}{m{2.48cm}|}{({в процентах)}}\\\hhline{~----}
~ &
{Русск.} &
{Франц.} &
{Русск.} &
{Франц.}\\\hline
{Язык в целом} &
\raggedleft 1,37 &
\raggedleft 1,4 &
\raggedleft 72,6 &
\raggedleft\arraybslash 70,6\\\hline
{Разговорная речь} &
\raggedleft 1,4 &
\raggedleft 1,5 &
\raggedleft 72 &
\raggedleft\arraybslash 68,4\\\hline
{Литературный текст} &
\raggedleft 1,19 &
\raggedleft 1,38 &
\raggedleft 76,2 &
\raggedleft\arraybslash 71\\\hline
{Деловой текст} &
\raggedleft 0,83 &
\raggedleft 1,22 &
\raggedleft 83,4 &
\raggedleft\arraybslash 74,4\\\hline
\end{supertabular}
\end{flushleft}
{Из приведенной таблицы видно, что языки имеют весьма большую избыточность. Что означает, например, избыточность, составляющая 75\%? Это не означает буквально то, что любые 3 из 4 букв текста можно вычеркнуть без потери информации. Более точно это означает, что при оптимальном кодировании текста его можно сжать до четверти длины без потери информации.}

\subsection[{Р}{а}{с}{с}{т}{о}{я}{н}{и}{е} {е}{д}{и}{н}{с}{т}{в}{е}{н}{н}{о}{с}{т}{и}]{{Расстояние единственности}}
{При небольших длинах криптограмм результат ее расшифрования может дать несколько осмысленных текстов. Например, криптограмму }WNAJW, {полученную при использовании шифра сдвига для английского языка, порождают два открытых текста }RIVER {и }ARENA, {отвечающих ключам 5 и 22. При этом один из ключей является истинным, а другой – ложным. Аналогичная ситуация может иметь место для любого другого шифра.}

{Рассмотрим произвольный шифр, для которого множество открытых текстов представляет собой множество возможных осмысленных текстов в данном алфавите } $A$ ({например, }{русском), состоящем из } $\left|A\right|$ {букв. Зафиксируем некоторое число } $n$ {и будем интересоваться числом ложных ключей, отвечающих данной криптограмме } $c$ {состоящей из } $n$ {букв. Предполагается, что } $A$ {служит также алфавитом шифрованного текста. Пусть } $K\left(c\right)$ {множество ключей, для каждого из которых } $c$ {является результатом зашифрования некоторого осмысленного открытого текста длины } $n$. {Следовательно, число ложных ключей равно } $\left|K\left(c\right)\right|-1$. {Определим среднее число ложных ключей } $s_n$ ({относительно всех возможных криптограмм длины } $n$) {формулой,}

\begin{equation*}
s_n=\sum _{c{\in}C,\left|c\right|=n}p\left(y\right){\cdot}\left(\left|K\left(c\right)\right|-1\right)=?\sum _{c{\in}C,\left|c\right|=n}p\left(y\right){\cdot}\left|K\left(c\right)\right|-1
\end{equation*}
{Теорема. }{Для любого рассматриваемого шифра } $S=\left(M,C,K,e,d,P\left(M\right),P\left(K\right)\right)$ {с равновероятными ключами при достаточно больших } $n$ {имеет место неравенство}

 $s_n{\geq}\frac{\left|K\right|}{\left|A\right|^{n{\cdot}R_L}}-1$[F082?]

{Назовем расстоянием единственности для шифра натуральное число } $n_0$, {для которого ожидаемое число ложных ключей равно нулю.}

{Для получения оценки расстояния единственности для шифра с равновероятными ключами воспользуемся неравенством теоремы. Полагая } $s_n=0$, {получим из него оценку } $n{\geq}\frac{\mathit{lo}g_2\left|K\right|}{R_L\mathit{lo}g_2\left|A\right|}$. {Минимально возможное значение } $n$ {в этом неравенстве и принимаем за } $n_0$. {Таким образом, } $n_0=\text{[2308?]}\frac{\mathit{lo}g_2\left|K\right|}{R_L\mathit{lo}g_2\left|A\right|}\text{[2309?]}$. {Несмотря на некоторую некорректность вывода этой формулы, она тем не менее хорошо согласуется с практикой, и поэтому ею пользуются. Например, для шифра простой замены для английского языка формула дает оценку } $n_0=38$. {Это значит, что для английского языка в среднем по криптограмме длиной около 40 можно однозначно определить открытый текст, что приблизительно соответствует практическому опыту.}

\subsection[{С}{т}{о}{й}{к}{о}{с}{т}{ь} {ш}{и}{ф}{р}{о}{в}]{{Стойкость шифров}}
{Различают два вида надежности шифров: теоретическую и практическую (вычислительную). Говоря неформально, криптографическая система называется вычислительно стойкой, если наилучший из возможных алгоритмов, взламывающих ее, требует неоправданно высоких затрат вычислительных ресурсов. Например, как мы убедились, шифр сдвига, шифр замены и шифр Виженера не являются вычислительно стойкими, поскольку их можно раскрыть, имея довольно скромные вычислительные ресурсы. К вычислительно стойким системам можно отнести криптосистемы }DES, Rijndael, RSA. {С ними мы познакомимся позже. С другой стороны, при рассмотрении вопроса о теоретической стойкости шифров мы не ограничиваем вычислительной мощности криптоаналитика, то есть во главу угла ставится принципиальная возможность получения некоторой информации об открытом тексте или использованном ключе. Впервые такой подход исследовал К. Шеннон. Он рассматривал уже знакомую нам модель шифра и единственную криптоатаку, при которой криптоаналитик может перехватить только криптограммы. Проследим за его рассуждениями.}

{Как мы указывали, конечной целью работы криптоаналитика является текст сообщения или ключ шифрования. Однако весьма полезной может быть даже некоторая вероятностная информация об открытом тексте. Например, уже предположение о том, что открытый текст по-английски, предоставляется криптоаналитику определенную априорную информацию об этом сообщении даже до того, как он увидит шифртекст. Так, например, он заранее знает, что слово {\textquotedbl}}hello{\textquotedbl} {является более вероятным началом сообщения, чем, скажем, набор букв {\textquotedbl}}abcde{\textquotedbl}. {Поэтому первая цель криптоанализа состоит в том, чтобы увеличить количество этой априорной информации, относящейся к каждому возможному открытому тексту таким образом, чтобы истинный открытый текст сделать более вероятным после получения шифртекста, хотя, конечно, и не обязательно точным.}

{Пусть, например, криптоаналитик перехватил текст {\textquotedbl}}abccd{\textquotedbl} {и знает, что он был зашифрован при помощи шифра простой замены. Этот шифртекст говорит ему о том, что открытый текст состоит из пяти букв, третья и четвертая из которых являются одинаковыми, а остальные отличными от этой буквы и разными. Хотя он не может быть уверенным, что этим словом является {\textquotedbl}}hello{\textquotedbl} ({это может быть еще {\textquotedbl}}lessy{\textquotedbl} {или что-то подобное), тем не менее, апостериорные вероятности таких открытых текстов возрастают относительно их априорных вероятностей. Криптоаналитик, кроме того, полностью уверен (в предположении, что использовалась именно простая замена) в том, что этот скрытый текст не может быть ни словом {\textquotedbl}}after{\textquotedbl}, {ни словом {\textquotedbl}}catch{\textquotedbl}, {и, таким образом, апостериорная вероятность обоих этих открытых текстов сокращается до нуля, даже вне зависимости от их априорных вероятностей.}

{Шеннон назвал шифр совершенным, если для любого открытого теста знания, которые могут быть получены из соответствующего ему шифртекста, не раскрывают никакой информации об открытом тексте, за исключением, возможно, его длины. Другими словами, для совершенных шифров апостериорные вероятности открытых текстов (вычисленные после получения криптограммы) совпадают с их априорными вероятностями.}

{Вспомним о введенной нами модели шифра, в которой фигурировали распределения вероятностей открытых текстов и ключей. Они как раз и являются наборами априорных вероятностей. Далее мы будем рассматривать лишь такие шифры, для которых выбор ключа и }{выбор открытого текста являются независимыми событиями. Эти распределения естественным образом индуцируют распределение вероятностей криптограмм } $c{\in}C$:

\begin{equation*}
p\left(c\right)=\sum _{m{\in}M,k{\in}K:e\left(m,k\right)=c}p\left(m\right)p\left(k\right)
\end{equation*}
{Естественным образом вводятся и условные вероятности } $p\left(c\vee m\right)$,  $p\left(c\vee k\right)$, {определяемые формулами:}

\begin{equation*}
p\left(c\vee m\right)=\sum _{k{\in}K:e\left(m,k\right)=c}p\left(k\right)
\end{equation*}
\begin{equation*}
p\left(c\vee k\right)=\sum _{m{\in}M:e\left(m,k\right)=c}p\left(m\right)
\end{equation*}
{Определение.} {Назовем шифр совершенным, если для любых } $m{\in}M$,  $c{\in}C$ {выполняется равенство } $p\left(m\vee c\right)=p\left(m\right)$.

{Отметим одно очевидное свойство совершенного шифра.}

{Утверждение.} {Если шифр совершенный, то } $\left|M\right|{\leq}\left|C\right|{\leq}\left|K\right|$.

{В большинстве случаев применяемые на практике шифры имеют одинаковые числа открытых текстов и криптограмм. Такие шифры называются эндоморфными. К. Шеннону удалось полностью описать совершенные эндоморфные шифры с минимально возможным числом ключей, то есть случай } $\left|M\right|=\left|C\right|=\left|K\right|$.

{Теорема.} ({К. Шеннон) Пусть шифр такой, что } $\left|M\right|=\left|C\right|=\left|K\right|$. {Тогда шифр совершенный тогда и только тогда, когда выполняются два условия:}

\begin{enumerate}
\item {для любых } $m{\in}M$,  $c{\in}C$ {существует единственный ключ } $k{\in}K$, {для которого } $e\left(m,k\right)=c$;
\item {распределение вероятностей ключей равномерное, то есть для любого ключа } $p\left(k\right)=\frac 1{\left|K\right|}$.[F082?]
\end{enumerate}
{Шифр Вернама является примером совершенного шифра.}

\subsection[{Е}{щ}{е} {о} {т}{е}{о}{р}{е}{т}{и}{ч}{е}{с}{к}{о}{й} {с}{т}{о}{й}{к}{о}{с}{т}{и} {ш}{и}{ф}{р}{о}{в}]{{Еще о теоретической стойкости шифров}}
{Пусть имеются дискретные случайные величины } $\xi $ {и } $\eta $. {Для них можно вычислить совместное распределение } $P\left(\xi ,\eta \right)$ {и условные распределения } $P\left(\xi \vee y\right)$,  $P\left(\eta \vee x\right)$ {для любых фиксированных } $x{\in}\xi $,  $y{\in}\eta $.

{Определим условную энтропию } $H\left(\xi \vee y\right)$ {формулой }

\begin{equation*}
H\left(\xi \vee y\right)=-\sum _{x{\in}\xi }^{\Box }p\left(x\vee y\right){\cdot}\mathit{lo}g_2p\left(x\vee y\right)
\end{equation*}
{Усредненная (по всем } $y{\in}\eta $) {величина } $H\left(\xi \vee y\right)$ {называется условной энтропией двух вероятностных распределений:}

\begin{equation*}
H\left(\xi \vee \eta \right)=-\sum _{y{\in}\eta }\sum _{x{\in}\xi }p\left(y\right){\cdot}p\left(x\vee y\right){\cdot}\mathit{lo}g_2p\left(x\vee y\right)
\end{equation*}
{Величина } $H\left(\xi \vee \eta \right)$ {измеряет среднее количество информации о } $\xi $, {обнаруживаемое с помощью } $\eta $. {Известно, что имеет место равенство } $H\left(\xi \vee \eta \right){\leq}H\left(\xi \right)$, {причем равенство } $H\left(\xi \vee \eta \right)=H\left(\xi \right)$ {выполняется тогда и только тогда, когда } $\xi $ {и } $\eta $ {независимые случайные величины.}

{Назовем условную энтропию } $H\left(K\vee C\right)$ {неопределенностью шифра по ключу. Она измеряет среднее количество информации о ключе, которую дает криптограмма. Аналогично вводится неопределенность шифра по открытому тексту } $H\left(M\vee C\right)$. {Эти величины являются мерой теоретической стойкости шифра. В этом можно убедиться на основании следующих рассуждений.}

{Минимально возможным значением неопределенности шифра по открытому тексту является 0. Что можно сказать о шифре в этом случае? Ясно, что равенство } $H\left(M\vee C\right)=0$ {выполняется лишь тогда, когда каждое слагаемое в выражении для } $H\left(M\vee C\right)$ {равно нулю:}

\begin{equation*}
p\left(c\right){\cdot}p\left(m\vee c\right){\cdot}\mathit{lo}g_2p\left(m\vee c\right)=0
\end{equation*}
{для всех } $m{\in}M$ {и } $c{\in}C$. {Это возможно лишь в случае, когда } $p\left(m\vee c\right)=1$ {при некоторых } $m$ {и } $c$. {Это означает, что по данному } $c$ {можно получить существенную }{информацию о } $m$, {что свидетельствует о слабости шифра. Чем больше } $H\left(M\vee C\right)$, {тем меньше информации получает противник об открытом тесте по криптограмме. Идеальной является ситуация, когда } $H\left(M\vee C\right)=H\left(M\right)$. {Именно в этом случае шифр можно было бы назвать идеальным или совершенным. Такое представление полностью соответствует определению совершенного по К. Шеннону шифра.}

{Связь между энтропиями компонент шифра дает известная формула для неопределенности шифра по ключу: } $H\left(K\vee C\right)=H\left(M\right)+H\left(K\right)-H\left(C\right)$ {полученная К. Шенноном.}

\subsection{{Упражнения}}
\begin{enumerate}
\item {Дана {\textquotedbl}игрушечная{\textquotedbl} криптосистема в которой } $M=\left\{a,b,c,d\right\}$,  $C=\left\{W,X,Y,Z\right\}$ {и } $K=\left\{k_1,k_2,k_3,k_4\right\}$, {а функция шифрования задана таблицей}
\end{enumerate}
\begin{equation*}
\begin{matrix}a&b&c&d\\k_1&W&X&Y&Z\\k_2&X&Z&W&Y\\k_3&Z&W&X&Y\\k_4&Y&W&Z&X\end{matrix}
\end{equation*}
{Считайте, что все сообщения и ключи равновероятны.}

\begin{enumerate}
\item \begin{enumerate}
\item {Вычислите вероятности } $p\left(C=W\right)$,  $p\left(C=X\right)$,  $p\left(C=Y\right)$ {и } $p\left(C=Z\right)$
\end{enumerate}
\end{enumerate}
{Ответ:}

\begin{equation*}
p\left(C=W\right)=\frac 1 4{\cdot}\frac 1 4+\frac 1 4{\cdot}\frac 1 2+\frac 1 4{\cdot}\frac 1 4=\frac 1 4
\end{equation*}
\begin{equation*}
p\left(C=X\right)=\frac 1 4{\cdot}\frac 1 4+\frac 1 4{\cdot}\frac 1 4+\frac 1 4{\cdot}\frac 1 4+\frac 1 4{\cdot}\frac 1 4=\frac 1 4
\end{equation*}
\begin{equation*}
p\left(C=Y\right)=\frac 1 4{\cdot}\frac 1 4+\frac 1 4{\cdot}\frac 1 4+\frac 1 4{\cdot}\frac 2 4=\frac 1 4
\end{equation*}
\begin{equation*}
p\left(C=Z\right)=\frac 1 4{\cdot}\frac 1 4+\frac 1 4{\cdot}\frac 1 4+\frac 1 4{\cdot}\frac 1 4+\frac 1 4{\cdot}\frac 1 4=\frac 1 4
\end{equation*}
\begin{enumerate}
\item \begin{enumerate}
\item {Вычислите условные вероятности } $p\left(M=m\vee C=c\right)$ {для всех пар } $\left(m,c\right)$ {и оцените с помощью подсчитанных условных вероятностей, насколько хороша эта криптосистема.}
\end{enumerate}
\end{enumerate}

\bigskip

{Ответ:}

{Поскольку в нашем примере } $p\left(M=m\right)=p\left(C=c\right)=\frac 1 4$, {то } $p\left(M=m\vee C=c\right)=\frac{p\left(C=c\vee M=m\right){\cdot}p\left(M=m\right)}{p\left(C=c\right)}=p\left(C=c\vee M=m\right)$. {Отсюда легко вычисляются искомые условные вероятности:}

 $p\left(M=a\vee C=W\right)=\frac 1 4$, $p\left(M=b\vee C=W\right)=\frac 1 2$,  $p\left(M=c\vee C=W\right)=\frac 1 4$, $p\left(M=d\vee C=W\right)=0$,

 $p\left(M=a\vee C=X\right)=\frac 1 4$,  $p\left(M=b\vee C=X\right)=\frac 1 4$,  $p\left(M=c\vee C=X\right)=\frac 1 4$, $p\left(M=d\vee C=X\right)=\frac 1 4$.

 $p\left(M=a\vee C=Y\right)=\frac 1 4$,  $p\left(M=b\vee C=Y\right)=0$,  $p\left(M=c\vee C=Y\right)=\frac 1 4$, $p\left(M=d\vee C=Y\right)=\frac 1 2$.

 $p\left(M=a\vee C=Z\right)=\frac 1 4$,  $p\left(M=b\vee C=Z\right)=\frac 1 4$,  $p\left(M=c\vee C=Z\right)=\frac 1 4$, $p\left(M=d\vee C=Z\right)=\frac 1 4$.

{Криптосистема не очень хорошая, поскольку при перехвате криптограммы } $W$ {криптоаналитик будет достоверно знать, что открытый текст не равен } $d$ {и с большой вероятностью равен } $b$. {Криптосистема не является совершенной.}

\begin{enumerate}
\item \begin{enumerate}
\item {Вычислите энтропии } $H\left(K\right)$,  $H\left(M\right)$,  $H\left(C\right)$ {и } $H\left(K\vee C\right)$. {Подтверждают ли найденные значения выводы предыдущего упражнения?}
\end{enumerate}
\end{enumerate}
{Ответ:}

\begin{equation*}
H\left(K\right)=H\left(M\right)=H\left(C\right)=\mathit{lo}g_24=2
\end{equation*}
\begin{equation*}
H\left(K\vee C\right)=H\left(K\right)+H\left(M\right)-H\left(C\right)=2
\end{equation*}
{Таким образом, неопределенность ключа не уменьшается после перехвата шифротекста, что не подтверждает вывод предыдущего упражнения.}

\begin{enumerate}
\item {Ложный ключ}. {Пусть задана криптосистема (например, это может быть шифр замены, шифр сдвига, шифр Виженера и т.д.). При небольших длинах криптограмм для некоторых различных ключей из криптограммы могут получиться различные осмысленные тексты. При этом один из ключей является истинным, а остальные ложные. Приведите пример ложного ключа, то есть пример шифра, криптограммы и двух ключей, которые дают из криптограммы два различных осмысленных текста.}
\end{enumerate}
{Ответ:}

{Пусть фрагмент одного ключа шифра замены равен А-А, М-В, З-Ф, И-Ы и фрагмент другого ключа шифра замены равен О-А, Т-В, Л-Ф, Е-Ы. Тогда криптограмма ФЫВА в первом случае расшифровывается как ЗИМА, а во втором случае как ЛЕТО.}

\begin{enumerate}
\item {Расстояние единственности}. {Пусть задана криптосистема (в качестве примера возьмем шифр замены) для естественного языка } $L$ {в алфавите } $A$ {с числом букв в алфавите } $\left|A\right|$ ({например, если язык } $L$ {русский, то } $\left|A\right|=33$). {Рассмотрим криптограмму } $c{\in}C^n$ {длины } $n$. {Обозначим через } $K\left(c\right)$ {число всех ключей, которые преобразуют криптограмму } $c$ {в осмысленный текст. Тогда } $s\left(c\right)=K\left(c\right)-1$ {равно числу ложных ключей. Среднее число (вернее математическое ожидание или ожидаемое число) ложных ключей обозначается символом } $\acute s_n$. {Оно равно } $\acute s_n=\sum _{c{\in}C^n}p\left(C=c\right)\left(K\left(c\right)-1\right)$. {Известно, что } $\acute s_n{\geq}\frac{\left|K\right|}{\left|A\right|^{nR_L}}-1$, {где } $\left|A\right|$ - {число букв в алфавите языка, } $\left|K\right|$ - {число ключей в криптосистеме, } $R_L$ - {избыточность языка (для русского разговорного языка известно, что } $R_L=0,72$ (72\%)). {Расстоянием единственности шифра называют такую длину } $n_0$ {криптограмм, начиная с которой ожидаемое число } $\acute s_n$ {ложных ключей равно 0. Таким образом } $n_0{\approx}\frac{\mathit{lo}g_2\left|K\right|}{R_L\mathit{lo}g_2\left|A\right|}$. {Найдите приближенное значение расстояния единственности шифра замены для русского языка.}
\end{enumerate}
{Ответ: } $n_0{\approx}\frac{\mathit{lo}g_2\left|K\right|}{R_L\mathit{lo}g_2\left|A\right|}{\approx}\frac{\mathit{lo}g_233!}{0,72{\cdot}\mathit{lo}g_233}{\approx}\frac{\mathit{lo}g_2\left(8{\cdot}10^{36}\right)}{0,72{\cdot}\mathit{lo}g_233}{\approx}\frac{\mathit{lo}g_28+\mathit{lo}g_210^{36}}{0,72{\cdot}\mathit{lo}g_233}{\approx}\frac{3+120}{0,72{\cdot}5}{\approx}34$

\subsection[{В}{о}{п}{р}{о}{с}{ы} {н}{а} {э}{к}{з}{а}{м}{е}{н}.]{{Вопрос}{ы на экзамен.}}
\begin{enumerate}
\item {Вероятностная модель шифра.}
\item {Энтропия случайной величины.}
\item {Энтропия языка.}
\item {Избыточность языка.}
\item {Ложный ключ.}
\item {Расстояние единственности.}
\item {Совершенный шифр.}
\item {Стойкость шифров.}
\end{enumerate}
\end{document}
