
Пользуясь обозначениями, использованными в алгоритме Евклида, заметим, что
\[\frac{a_{i-1}}{a_i}=q_i+\frac{1}{\frac{a_i}{a_{i+1}}}\] 
Таким образом,
\[\frac{a_0}{a_1}=q_1+\frac{1}{q_2+\frac{1}{q_3+\dots +\frac{1}{q_n}}}\] 
Такая запись дроби $\frac{a_0}{a_1}$ называется разложением в \index{Дробь!непрерывная}\index{Дробь!цепная}{\it цепную (или непрерывную) дробь}. Другая ее запись: $\frac{a_0}{a_1}=\left[q_1;q_2,q_3,\dots ,q_n\right]$.

Обозначим
\[\delta_1=q_1\] 
\[\delta_2=q_1+\frac{1}{q_2}\] 
\[\delta_3=q_1+\frac{1}{q_2+\frac{1}{q_3}}\] 
\[\ldots \] 
\[\delta_i=[q_1;q_2,q_3,\dots ,q_i]\] 
\[\ldots \] 
\[\delta_n=[q_1;q_2,q_3,\dots ,q_n]\] 
Величины $\delta_i$ называются {\it подходящими дробями}\index{Дробь!подходящая}. Обозначим $P_0=1$, $Q_0=0$, $P_1=q_1$, $Q_1=1$. Заметим, что $\delta_i$ получается из ${\delta }_{i-1}$ заменой $q_{i-1}$на $q_{i-1}+\frac{1}{q_i}$, поэтому
\[{\delta }_1=\frac{q_1}{1}=\frac{P_1}{Q_1}\] 
%
\[\delta_2=q_1+\frac{1}{q_2}=\frac{q_1q_2+1}{q_2}=\frac{P_1\cdot q_2+P_0}{Q_1\cdot q_2+Q_0}=\left\{ \begin{array}{c}
P_2=P_1\cdot q_2+P_0 \\ 
Q_2=Q_1\cdot q_2+Q_0 \end{array}
\right\}=\frac{P_2}{Q_2}\] 
%
\[\delta_3=\frac{P_1\cdot \left(q_2+\frac{1}{q_3}\right)+P_0}{Q_1\cdot \left(q_2+\frac{1}{q_3}\right)+Q_0}=\frac{P_2\cdot q_3+P_1}{Q_2\cdot q_3+Q_1}=\left\{ \begin{array}{c}
P_3=P_2\cdot q_3+P_1 \\ 
Q_3=Q_2\cdot q_3+Q_1 \end{array}
\right\}=\frac{P_3}{Q_3}\] 
Если далее положить: 
\[P_i=P_{i-1}\cdot q_i+P_{i-2}\] 
\[Q_i=Q_{i-1}\cdot q_i+Q_{i-2}\] 
можно показать, что
\[\delta_i=\frac{P_i}{Q_i}\] 
Умножим правую и левую часть равенства $P_i=P_{i-1}\cdot q_i+P_{i-2}$ на $Q_{i-1}$. Аналогично умножим правую и левую часть равенства $Q_i=Q_{i-1}\cdot q_i+Q_{i-2}$ на $P_{i-1}$. Получим
\[P_iQ_{i-1}=P_{i-1}Q_{i-1}q_i+P_{i-2}Q_{i-1}\] 
\[P_{i-1}Q_i=P_{i-1}Q_{i-1}q_i+P_{i-1}Q_{i-2}\] 
Отнимем от верхнего равенства нижнее, получим:
\[P_iQ_{i-1}-{P_{i-1}Q}_i=P_{i-2}Q_{i-1}-{P_{i-1}Q}_{i-2}\] 
Таким образом, имеем:
\[P_iQ_{i-1}-{P_{i-1}Q}_i=-({P_{i-1}Q}_{i-2}-P_{i-2}Q_{i-1})\] 
\[{P_{i-1}Q}_{i-2}-P_{i-2}Q_{i-1}=-({P_{i-2}Q}_{i-3}-P_{i-3}Q_{i-2})\] 
\[\dots \] 
\[{P_2Q}_1-P_1Q_2=-({P_1Q}_0-P_0Q_1)\] 
\[{P_1Q}_0-P_0Q_1=-1\] 
Отсюда получаем формулу:
\[P_iQ_{i-1}-{P_{i-1}Q}_i=(-1)^i\] 
Поскольку 
$\delta_n=\frac{a_0}{a_1}=\frac{P_n}{Q_n}$, то из $P_nQ_{n-1}-P_{n-1}Q_n=(-1)^n$ следует $a_0Q_{n-1}-P_{n-1}a_1=(-1)^n$, т.е. 
\[a_0(-1)^nQ_{n-1}+a_1(-1)^{n+1}P_{n-1}=(-1)^n\] 
\[a_0Q_{n-1}=(-1)^n\pmod{a_1}\] 
\[a_0(-1)^nQ_{n-1}=1\pmod{a_1}\] 
Значит, одним из решений уравнения $a_0x+a_1y=1$ является
\[x=(-1)^nQ_{n-1}\] 
\[y=(-1)^{n+1}P_{n-1}\] 
Решениями уравнения
\[a_1y=1\pmod{a_0}\] 
являются $y=(-1)^{n+1}P_{n-1}+k\cdot a_0$, $k\in Z$. 


\subsection*{Упражнения}


\begin{enumerate}
	\item Покажите, что уравнение $a_0x+a_1y=1$ решается в целых числах тогда и только тогда, когда $(a_0,a_1)=1$.
	\item Покажите, что знаменатель и числитель $i$-ой подходящей дроби образуют несократимую дробь $\frac{P_i}{Q_i}$.
\end{enumerate}
