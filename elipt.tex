\section{Эллиптические кривые}
Алгебраической кривой\index{Кривая!алгебраическая} порядка $n$ над полем $F$ называется множество точек $\{(x,y)|x,y\in F, F(x,y)=0\}$ (или геометрическое место точек, удовлетворяющих уравнению $F(x,y)=0$), где $F(x,y)$~-- многочлен степени $n$ над полем $F$. Элементы множества $\{(x,y)|x,y\in F, F(x,y)=0\}$ называются точками кривой $F(x,y)=0$.

Точка $(x_0,y_0)$ кривой $F(x,y)=0$ называется неособой, если обе частные производные многочлена $F(x,y)$ не равны в ней $0$. Частные производные полинома $F(x,y)$ определяются обычной формулой, имеющей смысл для любого поля. Кривая называется неособой\index{Кривая!неособая}, или гладкой, если все её точки неособые, то есть в любой её точке $(x_0,y_0)$ можно провести касательную:

\[
\left.(x-x_0)\frac{\partial F}{\partial x}\right|_{(x,y)=(x_0,y_0)}+\left.(y-y_0)\frac{\partial F}{\partial y}\right|_{(x,y)=(x_0,y_0)}=0
\]
Неособая кривая третьего порядка над полем $F$ называется эллиптической\index{Кривая!эллиптическая} кривой над полем $F$, если она содержит хотя бы одну точку.

Всякую эллиптическую кривую над полем $F$ с помощью проективной замены координат

\[
\begin{array}{cc}
 x=\frac{a'_1+b'_1x+c'_1y}{a'_3+b'_3x+c'_3y},& y=\frac{a'_2+b'_2x+c'_2y}{a'_3+b'_3x+c'_3y} \\ 
 \end{array}
\]
можно привести к виду (к форме Вейерштрасса)\index{Кривая!эллиптическая!форма Вейерштрасса}
\begin{equation}
y^2+a_1xy+a_3y=x^3+a_2x^2+a_4x+a_6	
\end{equation}
Если характеристика поля $F$ не равна $2$ ($\charact F\neq 2$), то эллиптическую кривую можно привести к следующему виду (тоже называется формой Вейерштрасса)
\begin{equation}
	y^2=x^3+a_2x^2+a_4x+a_6
\end{equation}
Если $\charact F\neq 2$ и $\charact F\neq 3$, то эллиптическую кривую можно представить в следующей форме Вейерштрасса:
\begin{equation}\label{eliptab}
	y^2=x^3+ax+b
\end{equation}
Кривая \ref{eliptab} обозначается $E_{a,b}(F)$. Величина $\Delta=\left(\frac{a}{3}\right)^3+\left(\frac{b}{2}\right)^2=\frac{4a^3+27b^2}{108}$ называется детерминантом кривой $E_{a,b}(F)$. Кривая~\ref{eliptab} является неособой тогда и только тогда, когда её детерминант не равен нулю.

\subsection{Пример приведения кривой Ферма к форме Вейерштрасса}  Приведем кривую Ферма, заданную уравнением $x^3+y^3=1$ над полем действительных чисел, к форме Вейерштрасса.
Сделаем замену:
\[
\begin{array}{cc}
 x=\frac{1-6y}{6x},& y=\frac{1+6y}{6x} \\ 
 \end{array}
\]
Получаем:
$$\frac{(1-6y)^3}{6^3x^3}+\frac{(1+6y)^3}{6^3x^3}=1\Rightarrow (1-6y)^3+(1+6y)^3=6^3x^3\Rightarrow$$
$$\Rightarrow 1-3\cdot 6y+3(6y)^2-(6y)^3+1+3\cdot 6y+3(6y)^2+(6y)^3=6^3x^3\Rightarrow$$
$$\Rightarrow 2+6^3y^2=6^3x^3\Rightarrow y^2=x^3-\frac{1}{108}$$


\begin{figure}
	\centering
		\includegraphics[scale=0.4]{./ris4.eps}
%		\includegraphics[width=0.81\textwidth]{./ris.png}
	\caption{Рисунок фрагмента эллиптической кривой $y^2=x^3-x+1$ над полем действительных чисел, $\Delta<0$.}
	\label{fig:ris4}
\end{figure}

\begin{figure}
	\centering
		\includegraphics[scale=0.4]{./ris5.eps}
%		\includegraphics[width=0.81\textwidth]{./ris.png}
	\caption{Рисунок фрагмента эллиптической кривой $y^2=x^3-x$ над полем действительных чисел, $\Delta>0$.}
	\label{fig:ris5}
\end{figure}

\section{Эллиптическая кривая в проективной плоскости}
Для полинома $F(x,y)$ степени $n$ определим соответствующий {\it однородный полином} 
$\tilde{F}(x,y,z)$ трех переменных, домножая каждый моном $x^iy^j$, входящий в $F(x,y)$, на 
$z^{n-i-j}$. Из определения следует, что 
$\tilde{F}(x,y,z)=z^nF(\frac{x}{z},\frac{y}{z})$ и $\tilde{F}(x,y,1)=F(x,y)$.

Обозначим $F(x,y)=x^3+a_2x^2z+a_4xz^2+a_6z^3-(y^2z+a_1xyz+a_3yz^2)$.
Если $(x',y',z')$ является корнем уравнения $\tilde{F}(x,y,z)=0$, то и $(\alpha x',\alpha y',\alpha z')$ является корнем уравнения $\tilde{F}(x,y,z)=0$ для любого $\alpha\in F$. Множество точек $\{(\alpha x',\alpha y',\alpha z')|\alpha\in F\}$ образует прямую в трехмерном пространстве $F^3$. В так называемой проективной плоскости эта прямая является точкой с однородной координатой $(x':y':z')$, при этом для любого числа $\alpha$ из поля $F$ точка на проективной плоскости с координатами $(\alpha x':\alpha y':\alpha z')$ совпадает с точкой $(x':y':z')$. В проективной плоскости эллиптическая кривая $\tilde{F}(x,y,z)=0$ состоит из точки $(0:1:0)$ и точек $(x':y':1)$, где $(x',y')$ корень уравнения $F(x,y)=0$.
\paragraph*{Упражнение} Убедитесь в этом.


\section{Группы на эллиптических кривых}
На множестве точек эллиптической кривой 
\[
F(x,y)=x^3+a_2x^2z+a_4xz^2+a_6z^3-(y^2z+a_1xyz+a_3yz^2)=0
\]
можно определить операцию, удовлетворяющую всем свойствам группы. Для обозначения этой операции используется аддитивная запись. Определяется операция следующим образом. Формально вводится нейтральный (нулевой, поскольку используется аддитивная запись) элемент $0$, по определению удовлетворяющий свойствам нейтрального элемента группы. Заметим, что нейтральный элемент в проективной системе координат является бесконечно удаленной точкой $(0:1:0)$.
Для каждой точки $A=(x,y)$ эллиптической кривой обратная (противоположная) точка $-A$ определяется как $-A=-(x,y)=(x,\tilde{y})=(x,-y-a_1x-a_3)$.
\paragraph*{Упражнение}
Докажите, что если $(x,y)$ принадлежит эллиптической кривой 
\[y^2+a_1xy+a_3y=x^3+a_2x^2+a_4x+a_6,\] 
то и 
$(x,\tilde{y})=(x,-y-a_1x-a_3)$ принадлежит этой кривой.
\paragraph*{Упражнение} Докажите, что $(x,\tilde{\tilde{y}})=(x,y)$.

Заметим (покажите это), что в случае, когда характеристика поля не равна $2$ и эллиптическая кривая находится в форме Вейерштрасса, то $-(x,y)=(x,-y)$. В случае, если поле имеет характеристику $2$ и кривая находится в форме Вейерштрасса, то $-(x,y)=(x,y\oplus 1)$ или $-(x,y)=(x,x\oplus y)$, где $\oplus=+\pmod{2}$. По определению полагаем, что $A+(-A)=(-A)+A=0$.
Таким образом, мы определили, что
\begin{enumerate}
	\item $0+0=0$
	\item $A+0=0+A=A$
	\item $A=(x,y)\Rightarrow -A=(x,-y-a_1x-a_3)$
	\item $A+(-A)=(-A)+A=0$
\end{enumerate}

Заметим, что с одинаковыми абсциссами на кривой существует не больше двух точек. Докажите это.

Теперь нам осталось определить сумму двух точек $A+B$, когда $B\neq -A$ и $B\neq 0$.
Пусть $A=(x_0,y_0)$ и $B=(x_1,y_1)$. Если $A\neq B$, проведем через точки $A$ и $B$ прямую:
\[
y=\frac{y_1-y_0}{x_1-x_0}x-\frac{y_1-y_0}{x_1-x_0}x_0+y_0.
\]
Если $A=B$, то проведем через $A$ касательную прямую:
\[
\left.(x-x_0)\frac{\partial F}{\partial x}\right|_{(x,y)=(x_0,y_0)}+\left.(y-y_0)\frac{\partial F}{\partial y}\right|_{(x,y)=(x_0,y_0)}=0.
\]
Для удобства будем считать, что касательная прямая в точке $A$ касается эллиптической кривой дважды или, лучше сказать, в двух точках $A$ и $B$. В некотором смысле это даже верно.

В обоих случаях представим прямую в виде
\[
y=kx+c
\]
и найдем третью точку пересечения этой прямой $(x_2,y_2)$ с эллиптической кривой (она обязательно существует!). Для этой цели уравнение прямой подставляется в уравнение кривой и получают уравнение
\[
F(x,kx+c)=0
\]
от переменной $y$, где $F(x,kx+c)$ полином третьей степени, т.е.
\[
F(x,y)=x^3+\alpha_2x^2+\alpha_1x+\alpha_0.
\]
По теореме Виета справедливо, что 
\[
x_0+x_1+x_2=-\alpha_2.
\]
Таким образом, абцисса третьей точки вычисляется так
\[
x_2=-\alpha_2-x_0-x_1.
\]
Ордината $y_2$ вычисляется подстановкой $x_2$ в уравнение прямой
\[
y_2=kx_2+c.
\]

Наконец, по определению, полагаем
\[
A+B=-(x_2,y_2)=(x_2,-y_2-a_1x_2-a_3).
\]
Эта формула содержит в себе и случай $A=B$:
\[
2A=-(x_2,y_2)=(x_2,-y_2-a_1x_2-a_3).
\]
Далее приведены примеры, иллюстрирующие введенную таким образом операцию суммы точек на эллиптической кривой.

\subsection{Пример группы на эллиптической кривой над полем $GF(2)[z]/(z^3+z+1)$} 

Построим график эллиптической кривой $y^2+xy=x^3+(z+1)x^2+z^2+z$ над полем 
$GF(2)[z]/(z^3+z+1)$ и для произвольной точки $A$ кривой найдем $2A$, $3A$, $4A$.

Заметим, что рассматриваемое поле имеет характеристику $2$. Для нас это значит, что $2=0$ и $-1=1$. Составим для удобства таблицу умножения в поле $GF(2)[z]/(z^3+z+1)$:
\[
	\begin{array}[t]{|c|c|c|c|c|c|c|}
	\hline
	1				& z 	 	& z+1 	& z^2 	& z^2+1 & z^2+z & z^2+z+1	\\ 
	\hline
	z 			& z^2 	& z^2+z & z+1 	& 1 		&z^2+z+1& z^2+1 	\\ 
	\hline
	z+1 		& z^2+z	& z^2+1	&z^2+z+1& z^2 	& 1 		& z \\
	\hline
	z^2 		& z+1 	&z^2+z+1&z^2+z  & z 		& z^2+1 &  1 \\
	\hline
	 z^2+1	& 1 		&z^2		& z 		&z^2+z+1& z+1 	& z^2+z \\
	\hline
	z^2+z 	&z^2+z+1& 1	 		& z^2+1 & z+1 	& z &  z^2\\
	\hline
	z^2+z+1 & z^2+1 &  z		& 1 		& z^2+z & z^2 &  z+1 \\
	\hline
	\end{array}
\]

Найдем все точки эллиптической кривой $F(x,y)=x^3+(z+1)x^2+z^2+z-y^2-xy=0$. Поскольку поле $GF(2)[z]/(z^3+z+1)$ имеет характеристику $2$, то уравнение кривой равносильно $F(x,y)=x^3+(z+1)x^2+z^2+z+y^2+xy=0$.
Переберем все значения $x\in\{0,1,z,z+1,z^2,z^2+1,z^2+z, z^2+z+1\}$ и для каждого из них с помощью таблицы умножения, подставляя $x$ в уравнение кривой, найдем соответствующие значения $y$, если они существуют, такие, что $F(x,y)=0$.
В итоге получим:

\begin{enumerate}
	\item при $x=0$ имеем $y^2=z^2+z$ и $y=z^2$,
	\item при $x=1$ имеем  $y(y+1)=z^2$ и $y_1=z^2+z$, $y_2=z^2+z+1$, 
\item при $x=z$ имеем  $y(y+z)=z$ и решений относительно $y$ нет,
\item при $x=z+1$ имеем $y(y+z+1)=z^2+z$ и решений относительно $y$ нет,
	\item при $x=z^2$ имеем $y(y+z^2)=z$ и $y_1=z+1$, $y_2=z^2+z+1$, 
\item при $x=z^2+1$ имеем $y(y+z^2+1)=z$ и решений относительно $y$ нет,
	\item при $x=z^2+z$ имеем $y(y+z^2+z)=z^2+z+1$ и $y_1=1$, $y_2=z^2+z+1$, 
	\item при $x=z^2+z+1$ имеем $y(y+z^2+z+1)=1$ и $y_1=z$, $y_2=z^2+1$. 
\end{enumerate}

График эллиптической кривой показан на рис.~\ref{fig:elipt1}

\begin{figure}
	\centering
		\includegraphics[scale=0.5]{./elipt1.eps}
%		\includegraphics[width=0.81\textwidth]{./ris.png}
	\caption{График кривой $y^2+xy=x^3+(z+1)x^2+z^2+z$ над полем 
$GF(2)[z]/(z^3+z+1)$.}
	\label{fig:elipt1}
\end{figure}

Возьмем в качестве точки $A=(x_0,y_0)=(x_1,y_1)$ точку $(1,z^2+z)$ и найдем $2A$. Заметим, что мы написали $A=(x_0,y_0)=(x_1,y_1)$ для удобства, подразумевая тем самым, что касательная, в некотором смысле, пересекает кривую в этой точке дважды. Чтобы найти $2A$, надо найти уравнение касательной в точке $A$ к эллиптической кривой и третью точку $(x_2,y_2)$ пересечения касательной с кривой. Тогда $2A=-(x_2,y_2)=(x_2,x_2\oplus y_2)$, где $\oplus=+\pmod{2}$. Для этого найдем  
$\left.\frac{\partial F}{\partial x}\right|_{(x,y)=(x_0,y_0)}$ и 
$\left.\frac{\partial F}{\partial y}\right|_{(x,y)=(x_0,y_0)}$, не забывая учитывать характеристику 2 рассматриваемого поля.

\[\left.\frac{\partial F}{\partial x}\right|_{(x,y)=(1,z^2+z)}=
3x^2+2(z+1)x+y=x^2+y=z^2+z+1\] 
 
\[\left.\frac{\partial F}{\partial y}\right|_{(x,y)=(1,z^2+z)}=
2y+x=x=1.\]

Значит уравнение касательной имеет вид:

\[
(z^2+z+1)(x+1)+(y+z^2+z)=0
\]

Выразим в уравнении касательной $y$ через $x$:
\[
y=(z^2+z+1)x+1
\]
и подставим $y$ в уравнение эллиптической кривой:
\[
F(x,(z^2+z+1)x+1)=x^3+(z+1)x^2+z^2+z+((z^2+z+1)x+1)^2+x((z^2+z+1)x+1)=0.
\]

По теореме Виета сумма корней приведенного многочлена третьей степени равна взятому со знаком минус коэффициенту при $x^2$, то есть в нашем случае
\[
x_0+x_1+x_2=-(z+1+(z^2+z+1)^2+(z^2+z+1))=z^2+z+1.
\]
Поэтому
\[
x_2=z^2+z+1.
\]
и, пользуясь уравнением касательной, получаем
\[
y_2=(z^2+z+1)x_2+1=(z^2+z+1)(z^2+z+1)+1=z+1+1=z,
\]
и, наконец,
\[
2A=-(x_2,y_2)=-(z^2+z+1,z)=(z^2+z+1,z^2+1).
\]
Подтверждением тому, что мы не ошиблись во время вычислений, служит существование этой точки на рис.~\ref{fig:elipt1}.

Теперь найдем, чему равно $A+2A=3A$. Для этого, согласно алгоритму, найдем прямую, проходящую через точки $A=(x_0,y_0)=(1,z^2+z)$ и $2A=(x_1,y_1)=(z^2+z+1,z^2+1)$. Найдем третью точку $(x_2,y_2)$ пересечения этой прямой с эллиптической кривой. Тогда $3A=-(x_2,y_2)=(x_2,x_2+y_2)$.

Прямая, проходящая через две точки $(x_0,y_0)$ и $(x_1,y_1)$ такие, что $x_0\neq x_1$ и $y_0\neq y_1$,
имеет вид 
\[
\frac{y-y_0}{y_1-y_0}=\frac{x-x_0}{x_1-x_0}
\]
или, что более удобно для наших целей,
\[
y=\frac{y_1-y_0}{x_1-x_0}x-\frac{y_1-y_0}{x_1-x_0}x_0+y_0.
\]
Подставим известные нам значения в уравнение прямой, учитывая, что $-1=+1$. Получим
\[
y=\frac{z^2+1+z^2+z}{z^2+z+1+1}x+\frac{z^2+1+z^2+z}{z^2+z+1+1}1+z^2+z
\]
и, после преобразований,
\[
y=(z^2+1)x+z+1.
\]
Подставим уравнение прямой в уравнение эллиптической кривой:
\[
F(x,(z^2+1)x+z+1)=x^3+(z+1)x^2+z^2+z+((z^2+1)x+z+1)^2+x((z^2+1)x+z+1)=0.
\]
По теореме Виета:
\[
x_0+x_1+x_2=(z+1)+(z^2+1)^2+(z^2+1)=z+1+z^2+z+1+z^2+1=1.
\]
Таким образом, получаем
\[
x_2=x_0+x_1+1=1+z^2+z+1+1=z^2+z+1.
\]
и, подставляя $x_2$ в уравнение прямой,
\[
y_2=(z^2+1)x_2+z+1=(z^2+1)(z^2+z+1)+z+1=z^2+z+z+1=z^2+1.
\]
И, наконец,
\[
3A=-(x_2,y_2)=-(z^2+z+1,z^2+1)=(z^2+z+1,z).
\]

Найдем точку $4A$. Сначала мы представим $4A$ как $2A+2A$, а затем как $A+3A$, чтобы лишний раз убедиться в правильной работе алгоритма сложения точек на эллиптической кривой.

Чтобы найти $2A+2A$, надо найти уравнение касательной кривой, проходящую через точку $2A$.
Обозначим $2A=(x_0,y_0)=(x_1,y_1)=(z^2+z+1,z^2+1)$.
Найдем
\[\left.\frac{\partial F}{\partial x}\right|_{(x_0,y_0)}
=\left.x^2+y\right|_{(x_0,y_0)}=(z^2+z+1)^2+z^2+1=z^2+z\] 
и 
\[\left.\frac{\partial F}{\partial y}\right|_{(x_0,y_0)}=
\left.x\right|_{(x_0,y_0)}=z^2+z+1.\]
Уравнение касательной имеет вид:
\[
(z^2+z+1)(y+z^2+1)+(z^2+z)(x+z^2+z+1)=0.
\]
Выразим $y$ через $x$:
\[
y=(z^2+1)x+z+1.
\]
Подставим выраженный таким образом $y$ в уравнение кривой:
\[
F(x,y)=x^3+(z+1)x^2+z^2+z-y^2-xy=0.
\]
Получим
\[
F(x,(z^2+1)x+z+1)=x^3+(z+1)x^2+z^2+z-((z^2+1)x+z+1)^2-x((z^2+1)x+z+1)=0.
\]
Это уравнение относительно $x$ имеет три корня $x_0$, $x_1$, $x_2$. По теореме Виета
\[
x_0+x_1+x_2=(z+1)+(z^2+1)^2+(z^2+1)=1.
\]
Откуда, поскольку $x_0=x_1$,
\[
x_2=1.
\]
Найдем $y$:
\[
y_2=z^2+z
\]
и, наконец,
\[
4A=-(1,z^2+z)=(1,z^2+z+1).
\]

Найдем теперь $4A$ как $A+3A$. Обозначим $A=(x_0,y_0)=(1,z^2+z)$, $3A=(x_1,y_1)=(z^2+z+1,z)$.
Уравнение прямой, проходящей через точки $A$ и $3A$:
\[
y=(z^2+z+1)x+1.
\]
Подставим уравнение прямой в уравнение эллиптической кривой:
\[
F(x,(z^2+z+1)x+1)=x^3+(z+1)x^2+z^2+z-((z^2+z+1)x+1)^2-x((z^2+z+1)x+1)=0.
\]
Применяем теорему Виета:
\[
x_0+x_1+x_2=z^2+z+1,
\]
\[
x_2=z^2+z+1+x_0+x_1=z^2+z+1+1+z^2+z+1=1,
\]
\[
y_2=(z^2+z+1)x_2+1=z^2+z,
\]
\[
4A=-(1,z^2+z)=(1,z^2+z+1).
\]
Мы получили такой же результат, что и раньше.
Результаты всех вычислений примера показаны на рис.~\ref{fig:elipt2}.
\begin{figure}
	\centering
		\includegraphics[scale=0.5]{./elipt2.eps}
%		\includegraphics[width=0.81\textwidth]{./ris.png}
	\caption{Результаты сложения точек: $A$, $A+A$, $A+A+A$, $A+A+A+A$.}
	\label{fig:elipt2}
\end{figure}

\subsection{Пример группы на эллиптической кривой над полем $GF(3)[z]/(z^2+1)$} 

Построим график эллиптической кривой $y^2=x^3+(z+2)x^2+(z+1)x+2z+1$ над полем 
$GF(3)[z]/(z^2+1)$ и для произвольной точки $A$ кривой найдем $2A$ и $3A$.

Заметим, что рассматриваемое поле имеет характеристику $3$. Для наших целей отсюда следует, что $3=0$ и $-1=2$. Поле $GF(3)[z]/(z^2+1)$ содержит девять элементов $\{0,1,2,z,z+1,z+2,2z,2z+1,2z+2\}=
\{0,\pm 1,\pm z,\pm (z+1),\pm (z-1)\}$.
Составим для удобства таблицу умножения в поле $GF(3)[z]/(z^2+1)$. При этом таблицу составим не $9\times 9$, а более экономную $4\times 4$, пользуясь тем, что элементы остальной части таблицы получаются просто добавлением, где необходимо, знака минус. И умножение на $0$ тоже не вносим в таблицу.
\[
	\begin{array}[t]{|c|c|c|c|}
	\hline
	1				& z 	 		& z+1 		& z-1 	\\ 
	\hline
	z 			& -1 			& z-1 		& -(z+1) 	\\ 
	\hline
	z+1 		& z-1			& -z			& 1\\
	\hline
	z-1 		& -(z+1) 	& 1				& z  \\
	\hline
	\end{array}
\]

Найдем все точки эллиптической кривой $F(x,y)=x^3+(z-1)x^2+(z+1)x-z+1-y^2=0$.
Переберем все значения $x\in\{0,1,z,z+1,z-1,-1,-z,-(z-1),-(z+1)\}$ и для каждого из них с помощью таблицы умножения, подставляя $x$ в уравнение кривой, найдем соответствующие значения $y$, если они существуют, такие, что $F(x,y)=0$.
В итоге получим:

\begin{enumerate}
	\item при $x=0$ имеем $y^2=-z+1$ и решений относительно $y$ нет, 
	\item при $x=1$ имеем $y^2=1+z-1+z+1-z+1=z-1$ и решений относительно $y$ нет, 
	\item при $x=-1$ имеем $y^2=-1+z-1-z-1-z+1=-(z-1)$ и решений относительно $y$ нет, 
	\item при $x=z$ имеем  $y^2=-z-z+1+z-1-z+1=z-1$ и решений относительно $y$ нет, 
	\item при $x=-z$ имеем $y^2=z-z+1-z+1-z+1=z$ и $y=\pm (z-1)$, 
	\item при $x=z+1$ имеем $y^2=-z+1+z+1-z-z+1=z$ и $y=\pm (z-1)$, 
	\item при $x=-(z+1)$ имеем $y^2=z-1+z+1+z-z+1=-(z-1)$ и решений относительно $y$ нет,
	\item при $x=z+2$ имеем $y^2=-z-1-z-1+1-z+1=0$ и $y=0$, 
	\item при $x=-(z+2)$ имеем $y^2=z+1-z-1-1-z+1=-z$ и $y=\pm (z+1)$. 
	
\end{enumerate}

График эллиптической кривой показан на рис.~\ref{fig:elipt3}

\begin{figure}
	\centering
		\includegraphics[scale=0.5]{./elipt3.eps}
%		\includegraphics[width=0.81\textwidth]{./ris.png}
	\caption{График кривой $F(x,y)=x^3+(z-1)x^2+(z+1)x-z+1-y^2=0$ над полем 
$GF(3)[z]/(z^2+1)$.}
	\label{fig:elipt3}
\end{figure}

Возьмем в качестве точки $A=(x_0,y_0)=(x_1,y_1)$ точку $(-(z+2),z+1)$ и найдем $2A$. Заметим еще раз, что мы написали $A=(x_0,y_0)=(x_1,y_1)$ для удобства, подразумевая тем самым, что касательная, в некотором смысле, пересекает кривую в этой точке дважды. Чтобы найти $2A$, надо найти уравнение касательной в точке $A$ к эллиптической кривой и третью точку $(x_2,y_2)$ пересечения касательной с кривой. Тогда $2A=-(x_2,y_2)=(x_2,-y_2)$. Для этого найдем  
$\left.\frac{\partial F}{\partial x}\right|_{(x,y)=(x_0,y_0)}$ и 
$\left.\frac{\partial F}{\partial y}\right|_{(x,y)=(x_0,y_0)}$, не забывая учитывать характеристику 3 рассматриваемого поля.

\[\left.\frac{\partial F}{\partial x}\right|_{(x,y)=(-(z-1),z+1)}=
2(z-1)x+(z+1)=-(z-1)(-(z-1))+z+1=-(z-1)\] 
 
\[\left.\frac{\partial F}{\partial y}\right|_{(x,y)=(-(z-1),z+1)}=
y=z+1.\]

Значит уравнение касательной имеет вид:

\[
(y-(z+1))(z+1)+(x+z-1)(-(z-1))=0
\]

Выразим в уравнении касательной $y$ через $x$:
\[
y=zx
\]
и подставим $y$ в уравнение эллиптической кривой:
\[
F(x,zx)=x^3+(z-1)x^2+(z+1)x-z+1-(zx)^2=0
\]

По теореме Виета сумма корней приведенного многочлена третьей степени равна взятому со знаком минус коэффициенту при $x^2$, то есть в нашем случае
\[
x_0+x_1+x_2=-((z-1)-z^2)=-z
\]
Поэтому
\[
x_2=-z-x_0-x_1=-z-2(-(z-1))=z+1.
\]
и, пользуясь уравнением касательной, получаем
\[
y_2=z(z+1)=z-1,
\]
и, наконец,
\[
2A=-(x_2,y_2)=-(z+1,z-1)=(z+1,-(z-1)).
\]
Подтверждением тому, что мы не ошиблись во время вычислений, служит существование этой точки на рис.~\ref{fig:elipt3}.

Теперь найдем, чему равно $A+2A=3A$. Для этого, согласно алгоритму, найдем прямую, проходящую через точки $A=(x_0,y_0)=(-(z-1),z+1)$ и $2A=(x_1,y_1)=(z+1,-(z-1))$. Найдем третью точку $(x_2,y_2)$ пересечения этой прямой с эллиптической кривой. Тогда $3A=-(x_2,y_2)=(x_2,-y_2)$.

Прямая, проходящая через две точки $(x_0,y_0)$ и $(x_1,y_1)$ такие, что $x_0\neq x_1$ и $y_0\neq y_1$,
имеет вид 
\[
y=\frac{y_1-y_0}{x_1-x_0}x-\frac{y_1-y_0}{x_1-x_0}x_0+y_0
\]
Подставим известные нам значения в уравнение прямой. Получим
\[
y=\frac{-(z-1)-(z+1)}{z+1-(-(z-1))}x-\frac{-(z-1)-(z+1)}{z+1-(-(z-1))}(-(z-1))+z+1
\]
и, после преобразований,
\[
y=-x-1
\]
Подставим уравнение прямой в уравнение эллиптической кривой:
\[
F(x,-x-1)=x^3+(z-1)x^2+(z+1)x-z+1-(-x-1)^2=0
\]
По теореме Виета:
\[
x_0+x_1+x_2=-(z-1-1)=-z-1.
\]
Таким образом, получаем
\[
x_2=-z-1-x_0-x_1=-z-1+z-1-z-1=-z.
\]
и, подставляя $x_2$ в уравнение прямой,
\[
y_2=-x_2-1=z-1
\]
И, наконец,
\[
3A=-(x_2,y_2)=-(-z,z-1)=(-z,-(z-1)).
\]
Результаты вычислений  показаны на рис.~\ref{fig:elipt4}.
\begin{figure}
	\centering
		\includegraphics[scale=0.5]{./elipt4.eps}
%		\includegraphics[width=0.81\textwidth]{./ris.png}
	\caption{Результаты сложения точек: $A$, $A+A$, $A+A+A$.}
	\label{fig:elipt4}
\end{figure}